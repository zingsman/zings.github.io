<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="业精于勤荒于嬉,行成于思毁于随。">
<meta property="og:type" content="website">
<meta property="og:title" content="ZingsMan">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="ZingsMan">
<meta property="og:description" content="业精于勤荒于嬉,行成于思毁于随。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZingsMan">
<meta name="twitter:description" content="业精于勤荒于嬉,行成于思毁于随。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> ZingsMan </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZingsMan</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-search">
          <a href="/search" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-search"></i> <br />
            
            搜索
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/04/shell中的函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/04/shell中的函数/" itemprop="url">
                  shell中的函数
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-04T16:57:32+08:00">
                2017-09-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Shell中的函数"><a href="#Shell中的函数" class="headerlink" title="Shell中的函数"></a>Shell中的函数</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>shell中，函数有关键字function，声明一个函数。有时候可以省略不写。函数就是多个指令的集合，方便重用和修改。</p>
<h2 id="写法格式"><a href="#写法格式" class="headerlink" title="写法格式"></a>写法格式</h2><p>常见的写法有：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">其中，函数名后的括号可以省略不写，不推荐。</span></div><div class="line"><span class="meta">#</span><span class="bash">标准写法，推荐</span></div><div class="line">function 函数名()&#123;</div><div class="line">    指令</div><div class="line">    return n</div><div class="line">&#125;</div><div class="line"><span class="meta">#</span><span class="bash">简化写法</span></div><div class="line">函数名()&#123;</div><div class="line">    指令</div><div class="line">    return n</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在执行函数时候，关键字function和括号都不应该带。执行：<br><code>函数名 参数1 参数2</code></p>
<h2 id="函数里的参数"><a href="#函数里的参数" class="headerlink" title="函数里的参数"></a>函数里的参数</h2><p>其中，函数里面的参数，都可以是使用<code>$1</code>  <code>$2</code>  <code>$#</code> <code>$*</code>  <code>$?</code> <code>$@</code> 来作为函数的参数来使用。其中<code>$0</code> 任然是父脚本的名称。<br>其中<code>$*</code>和<code>$@</code>的差别，可以看linux shell 老男孩的书46页。差别是： 他们在不使用 双引号时候，用法一模一样，都是读取shell的所有参数。 若使用双引号。则echo 出来的 <code>$*</code> 和 <code>$@</code> 内容一模一样。但是 <code>$*</code> 只是一个参数，记录所有值，如： <code>&quot;$1$2$3&quot;</code> ·而<code>$@</code>是多个参数来记录所有值，如：”$1”  “$2”…</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/04/shell中的case条件语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/04/shell中的case条件语句/" itemprop="url">
                  shell中的case条件语句
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-04T16:57:13+08:00">
                2017-09-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="sehll中，case条件语句的格式"><a href="#sehll中，case条件语句的格式" class="headerlink" title="sehll中，case条件语句的格式"></a>sehll中，case条件语句的格式</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>case 条件语句格式，常在shell中，用作服务脚本启动脚本。</p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>case条件语句的语法格式为：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">case "变量" in</div><div class="line">    值1)</div><div class="line">        指令1...</div><div class="line">        ;;    #结束标志</div><div class="line">    值2)</div><div class="line">        指令2...</div><div class="line">        ;;</div><div class="line">    *)             #当上面都不匹配时候，匹配这里</div><div class="line">        指令3...</div><div class="line">esac</div></pre></td></tr></table></figure></p>
<p>解释：<br>在上述case语句中，当条件语句（变量）的<code>值为1</code>时候，执行<code>指令1</code>，当值等于<code>2</code>时候，执行<code>指令2</code>。当上面指令<code>都不匹配</code>的时候，执行<code>指令3</code> 。此外注意不同行内容的缩进距离。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>case条件分支语句，多用于脚本启动文件编写。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/04/shell中的循环/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/04/shell中的循环/" itemprop="url">
                  shell中的循环
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-04T16:53:19+08:00">
                2017-09-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="shell中的循环"><a href="#shell中的循环" class="headerlink" title="shell中的循环"></a>shell中的循环</h1><h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>循环就是用于重复执行一条或一组指令。直到条件不再满足时候，停止。shell中参加的循环语句有：<code>while</code>，<code>until</code>，<code>for</code>，<code>select</code></p>
<h2 id="当型（while）和直到型（until）的循环语法"><a href="#当型（while）和直到型（until）的循环语法" class="headerlink" title="当型（while）和直到型（until）的循环语法"></a>当型（while）和直到型（until）的循环语法</h2><h2 id="while-循环的基本语法"><a href="#while-循环的基本语法" class="headerlink" title="while 循环的基本语法"></a>while 循环的基本语法</h2><p>在while的循环中，<code>条件表达式</code>成立为真，就执行do…done 里面的指令。每一次执行到done时候，就会重新判断<code>条件表达式</code>是否成立。直到不成立时候，才跳出循环。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">while &lt;条件表达式&gt;</div><div class="line">do</div><div class="line">    指令</div><div class="line">done</div></pre></td></tr></table></figure></p>
<h2 id="until-循环语句"><a href="#until-循环语句" class="headerlink" title="until 循环语句"></a>until 循环语句</h2><p>until 循环和whiel循环的用法和格式差不多。<strong>唯一区别：</strong> until是在<code>条件表达式不成立</code>时候，执行do…done 里面的循环体，直到<code>条件表达式成立为真</code>时候，才跳出循环体。结束循环。一般来说，这种用法很少。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">until &lt;条件表达式&gt;</div><div class="line">do</div><div class="line">    指令</div><div class="line">done</div></pre></td></tr></table></figure></p>
<h3 id="循环例子"><a href="#循环例子" class="headerlink" title="循环例子"></a>循环例子</h3><p>打印54321,利用while循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">i=5</div><div class="line">while (( i &gt; 1 ))</div><div class="line">#while [ $i -gt 1 ]</div><div class="line">#while [[$i&gt;1]]  #里面不能使用&gt;=</div><div class="line">do</div><div class="line">    echo $</div><div class="line">    (( i-- ))</div><div class="line">done</div></pre></td></tr></table></figure></p>
<p>使用until循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">i=5</div><div class="line">until [ $i -lt 1 ]</div><div class="line">do</div><div class="line">    echo $i</div><div class="line">    (( i-- ))</div><div class="line">done</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/04/shell-if-语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/04/shell-if-语句/" itemprop="url">
                  shell_if_语句
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-04T09:38:56+08:00">
                2017-09-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="shell脚本if语句的几种写法和格式"><a href="#shell脚本if语句的几种写法和格式" class="headerlink" title="shell脚本if语句的几种写法和格式"></a>shell脚本if语句的几种写法和格式</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>if条件判断语句，是控制流的非常重要的核心。自己在写shell脚本时候，总是忘记格式和写法。<br>if后面的条件判断语句，如果为真 0 ，就会执行then里面的表达式，如果为假，就会忽略then里面的命令。执行else里面的语句。else是匹配最近的一条if语句</p>
<h3 id="单分支结构"><a href="#单分支结构" class="headerlink" title="单分支结构"></a>单分支结构</h3><p>下面的条件表达式可以是： <strong>test命令</strong>,<strong>[ ]</strong>, <strong>[[]]</strong> ,<strong>(())</strong>，<strong>其他命令</strong></p>
<ul>
<li><p>第一种语法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if  &lt;条件表达式&gt;</div><div class="line">    then</div><div class="line">        指令</div><div class="line">fi</div></pre></td></tr></table></figure>
</li>
<li><p>第二种语法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if &lt;条件表达式&gt;;then</div><div class="line">    指令</div><div class="line">fi</div></pre></td></tr></table></figure>
</li>
</ul>
<p>-第三种语法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">if &lt;条件语句&gt;;then</div><div class="line">    if &lt;条件语句&gt;;then</div><div class="line">        指令1</div><div class="line">    fi</div><div class="line">    if &lt;条件语句&gt;;then</div><div class="line">        指令2</div><div class="line">    fi</div><div class="line">    指令0</div><div class="line">fi</div></pre></td></tr></table></figure></p>
<h3 id="双分支结构"><a href="#双分支结构" class="headerlink" title="双分支结构"></a>双分支结构</h3><ul>
<li>第一种语法<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if &lt;条件语句&gt;;then</div><div class="line">    指令1</div><div class="line">else</div><div class="line">    指令2</div><div class="line">fi</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="多分支结构"><a href="#多分支结构" class="headerlink" title="多分支结构"></a>多分支结构</h3><ul>
<li>第一种语法<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">if &lt;条件语句&gt;;then</div><div class="line">    指令1</div><div class="line">elif</div><div class="line">    then</div><div class="line">    指令2</div><div class="line">elif </div><div class="line">    then</div><div class="line">    指令3</div><div class="line">else</div><div class="line">    指令4</div><div class="line">fi</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>注意</strong> 多分支结构，每个elif都要带then，耳而最后的else，是不能带else的。</p>
<h3 id="if语句执行步骤"><a href="#if语句执行步骤" class="headerlink" title="if语句执行步骤"></a>if语句执行步骤</h3><p>if –&gt;（真）–&gt;指令<br>if –&gt;（假）–&gt;elif–&gt;（真）–&gt;指令<br>if –&gt;（假）–&gt;elif–&gt;（假）–&gt;ellse–&gt;指令</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/31/Vmware-6-5-Install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/31/Vmware-6-5-Install/" itemprop="url">
                  Vmware_6.5_Install
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-31T09:11:46+08:00">
                2017-08-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="vmware-搭建vsan集群教材"><a href="#vmware-搭建vsan集群教材" class="headerlink" title="vmware 搭建vsan集群教材"></a>vmware 搭建vsan集群教材</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>由于工作相关。以前自己看的明教教主的vmware5.5教学视频隔了很长一段时间。也没有动。最近在vmware官方试着安装了vsphere 6.5 一系列。</p>
<h2 id="简单知识点"><a href="#简单知识点" class="headerlink" title="简单知识点"></a>简单知识点</h2><ul>
<li>vmware 就是底层虚拟化技术。实现主机资源（cpu，内存，）和存储（光纤存储，iscsi）分离。集中管理，节约成本的很多功能。</li>
<li>vcenter 是vmware非常重要的主机。能够实现负载均衡，冗余等（上行链路），能够实现高可用性（HA），动态资源分配（DRS）。在线迁移等等一系列技术。</li>
<li>要实现vmware的HA和DRS的很多功能，前提条件是需要有 <strong>共享存储</strong> 比如：<code>FC</code> 和 <code>ISCSI</code> 。在实验环境没有这些，可用通过vmware的VSAN(Vphere Storage Area Network)技术.他是vmware的 存储技术<h2 id="下载软件"><a href="#下载软件" class="headerlink" title="下载软件"></a>下载软件</h2>链接：<a href="https://www.vmware.com/cn.html" target="_blank" rel="external">https://www.vmware.com/cn.html</a> 可以在官网注册账号免费评估，即可下载</li>
</ul>
<ol>
<li>VMware vSphere Hypervisor (ESXi ISO) image (Includes VMware Tools) 这个 esxi 6.5主机系统</li>
<li>VMware vCenter Server and modules for Windows 下载linux版的或者windows版的vcenter，这里我下载windows的vcenter</li>
<li>linux安装vcenter简单，中移教程文档里面有。<h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3>环境使用公司vmware上一条虚拟机（16C32G）装workstation虚拟机来完成。默认情况下，虚拟机是不支持64位虚拟化。需要打开cpu虚拟化功能。需要在网页版vcenter上虚拟机设置里面cpu设置。<br>一共有5台虚拟机。3台esxi主机（4C8G）一台windows server 2012 sp2 安装vcenter（4C8G）。一台windows server 2012（4C-8G）装NTP服务器和DNS服务器。<h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3></li>
<li>安装3台esxi主机，并配置相应的网络。设置静态ip，DNS，esxi主机自己名字，我dns前缀</li>
<li>安装1台虚拟机，做NTP服务器，和DNS服务器。配置如下：<br>首先安装NTP服务器：<br>打开注册表; regedit 依次打开：<br>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Parameters\Type<br>双击 AnnounceFlags文件，将值改为5<br>双击  Enabled文件 将值改为1<br>关闭注册表，重启windows 时间服务<br><code>$ net stop w32time</code><br><code>$ net start w32time</code><br>若关闭防火墙，则不需要加入规则，开启则加入防火墙规则：<br><code>netsh firewall add portopening protocol = UDP port =123 name = NTPSERVER</code><br>设置 win32time服务<br><code>gpedit.msc</code><br>执行上述命令后，计算机策略对话框打开，按照如下路径  计算机配置\管理模板\系统\windows 时间服务\时间提供程序 找到服务器设置文件。<br>双击  启用 Windows NTP 服务器，显示状态 已启用即可<br>修改本地启动模式<br>运行服务<code>services.msc</code>,找到  Windows Time 文件,点击属性，改为延迟自动启动。</li>
</ol>
<p>dns服务器安装：<br>打开角色服务器管理器，点击新建服务器角色。下一步，选择dns服务器。安装即可。<br>安装后在服务器管理器页面有dns服务器。点击进去，添加正向解析区域。添加主机即可。</p>
<ol>
<li>安装vcenter<br>安装center，把下载的iso挂着在cd上。里面有个自动运行的文件。直接自动运行，填写好相关的信息。直接安装。</li>
<li>安装成功后。登录vcenter上面。注意登录名是时候 vcenter@pengke.com 注意是@</li>
<li>添加规则：<br>先键数据中心，再建vsan集群（建立时候选择打开vsan）。打开HA和DRA等<br>在做vsan时候，必须声明一个缓存盘和容量盘，所以，除了系统盘，至少还需要2快盘。其中一块盘，必须是SDD（闪存类型）（默认是HDD）。一块即可。配置的交换机就必须是混杂模式了。<br>将默认的HDD改为SDD：<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">esxcli storage core device list # 查看硬盘信息并找到相关盘符</div><div class="line">esxcli storage nmp satp rule add --satp VMW_SATP_LOCAL --device mpx.vmhba0:C0:T1:L0 --option "enable_local enable_ssd" #建SATP规则，并将可选参数设置为enable_ssd，注意磁盘编号</div><div class="line">esxcli storage nmp satp rule list | grep enable_ssd #查看刚才创建的规则</div><div class="line">esxcli storage core claiming reclaim -d mpx.vmhba0:C0:T1:L0 #重新申明磁盘，也只有盘符</div><div class="line">esxcli storage core device list -d mpx.vmhba0:C0:T1:L0 #验证</div><div class="line"><span class="meta"></span></div><div class="line">#若想将SSD重新恢复至HDD，则执行</div><div class="line"> esxcli storage nmp satp rule remove --satp VMW_SATP_LOCAL --device="mpx.vmhba0:C0:T1:L0"</div><div class="line"> esxcli storage core claiming reclaim -d mpx.vmhba0:C0:T1:L0</div><div class="line"> esxcli storage core device list -d mpx.vmhba0:C0:T1:L0</div></pre></td></tr></table></figure>
</li>
</ol>
<p>做vsan，只需一块改为hdd就行，我这hdd用来做缓存盘。</p>
<ol>
<li>vsan的流量，需要vmkernel交换机，也可以使用默认的switec 0 也可以专门创建新的交换机来跑vsan流量。我直接使用的默认交换机。将所有HA，Vmotion。vsan等流量都往上面跑。</li>
<li>配置好交换机后。设置vsan配置<br>在vsan集群中，添加3个主机，配置点击存储配置。将3个主机的磁盘声明下，我有出系统盘后，2个磁盘。一个100G SDD 声明为 缓存盘，一个150 HDD声明为容量盘。就能看的3个主机vsan盘的数据盘变成了 450G。<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2>写文档写得匆忙，在自己配置过程中遇到了很多问题，开始安装好后登录。不知道加@。<br>安装好vcenter时，登录进去，直接新建数据中心，就直接添加主机，导致各个主机上虚拟机不能兼容迁移。应该 新建数据中心-新建集群-新建主机，才合理。还有管理网络配置，配置标准交换机，配置vmkernel交换机，配置分布式交换机。等。最后，HA功能和drs功能没有测试。找机会测试下。还有就是vmware6的主机聚集和主机互斥功能没有找到。带测试。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/18/python-picture-to-ascii/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/18/python-picture-to-ascii/" itemprop="url">
                  python_picture_to_ascii
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-18T11:15:26+08:00">
                2017-08-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="将图片转换成字符串图片"><a href="#将图片转换成字符串图片" class="headerlink" title="将图片转换成字符串图片"></a>将图片转换成字符串图片</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>学习python，作为入门python的基础项目。实验地址:<br><a href="https://www.shiyanlou.com/courses/370/labs/1191/document" target="_blank" rel="external">https://www.shiyanlou.com/courses/370/labs/1191/document</a></p>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul>
<li>pyhon 2.7环境</li>
<li>使用库 argparse库。参考： <a href="https://blog.ixxoo.me/argparse.html" target="_blank" rel="external">https://blog.ixxoo.me/argparse.html</a></li>
<li>实验 pillow(PIL) 库 <code>from PIL import Image</code></li>
<li>Python 基础<h2 id="大概思路"><a href="#大概思路" class="headerlink" title="大概思路"></a>大概思路</h2><strong>用颜色灰度值（0黑~255白）转换成对应的字符串**</strong><br>一般读取图片坐标，我们得到的是RGB值。将图片RGB值转换为灰度：<br><code>gray ＝ 0.2126 * r + 0.7152 * g + 0.0722 * b</code><br>我们处理要转换的图片，输入几个参数（argument库的使用）：</li>
</ul>
<ol>
<li>图片路径（必须参数）</li>
<li>另存字符画的路径（默认当前目录output.txt）(可选参数)</li>
<li>图片的长和宽(可选参数)<h3 id="处理过程"><a href="#处理过程" class="headerlink" title="处理过程"></a>处理过程</h3></li>
<li>首先，读取我们输入的参数。</li>
<li>使用PIL.image库打开我们的图片</li>
<li>通过for循环，对长宽的坐标进行循环，并处理<code>getpixel((j,i))</code>得到我们的RGB值。</li>
<li>将RGB值转到我们转换的字符串的函数中。输出相应的灰度值</li>
<li>显示结果</li>
</ol>
<h2 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#use python 2.7</span></div><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="comment">#使用pillow库</span></div><div class="line"><span class="keyword">import</span> argparse   <span class="comment">#使用argparse 库，能方便的处理参数</span></div><div class="line"></div><div class="line"><span class="comment"># command argument</span></div><div class="line"></div><div class="line">parser = argparse.ArgumentParser() <span class="comment">#定义一个变量对象，来设置参数信息</span></div><div class="line"></div><div class="line">parser.add_argument(<span class="string">"file"</span>,help = <span class="string">"input your picture"</span>)</div><div class="line"> <span class="comment"># "file"为必要参数。有--代表可选参数</span></div><div class="line">parser.add_argument(<span class="string">"-o"</span>,<span class="string">"--output"</span>, help = <span class="string">"if you want,input you result file"</span>) </div><div class="line"><span class="comment"># “-o”,是"--output"参数的简写。可选参数</span></div><div class="line">parser.add_argument(<span class="string">"--width"</span>,type = int, default = <span class="number">80</span>) </div><div class="line"><span class="comment">#定义可选参数，类型，和默认值</span></div><div class="line">parser.add_argument(<span class="string">"--height"</span>, type = int, default = <span class="number">80</span>)</div><div class="line"></div><div class="line">args = parser.parse_args()  <span class="comment"># 定义变量来获取参数</span></div><div class="line"></div><div class="line">IMG = args.file  <span class="comment">#文件图片</span></div><div class="line">WIDTH = args.width  <span class="comment"># 宽</span></div><div class="line">HEIGHT = args.height <span class="comment"># 高</span></div><div class="line">OUTPUT = args.output <span class="comment"># 另存为地址</span></div><div class="line"></div><div class="line">ascii_char = list(<span class="string">"$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\|()1&#123;&#125;[]?-_+~&lt;&gt;i!lI;:,\"^`'. "</span>)  </div><div class="line"><span class="comment"># 我们将0-255的颜色灰度值转换成这些字符串，即是越接近0，用越左边的字符串表示</span></div><div class="line"></div><div class="line"><span class="comment"># 256 clocr to 70 charstrings</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_char</span><span class="params">(r,g,b,alph = <span class="number">256</span>)</span>:</span></div><div class="line">    <span class="comment"># 为什么plph值默认值为:256, 而getpixel()穿过来的是[2,255]</span></div><div class="line">    <span class="keyword">if</span> alph == <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">' '</span></div><div class="line">    length = len(ascii_char)</div><div class="line">    gray = int(<span class="number">0.2126</span> * r + <span class="number">0.7152</span> * g + <span class="number">0.0722</span> * b)  <span class="comment">#灰度值的计算公式，固定</span></div><div class="line"></div><div class="line">    unit = (<span class="number">256.0</span> + <span class="number">1</span>)/length</div><div class="line">    <span class="keyword">return</span> ascii_char[int(gray/unit)]</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:   </div><div class="line"><span class="comment"># 好习惯编程，别人import你的模块，不会执行里面的内容</span></div><div class="line"></div><div class="line">    im = Image.open(IMG)  <span class="comment">#打开图片对象，用im，使用PIL.Image库</span></div><div class="line">    im = im.resize((WIDTH,HEIGHT),Image.NEAREST) </div><div class="line">    <span class="comment">#充值图片大小，就是返回你定义的长高图片对象.Image.NEAREST是默认方式。可以不研究.</span></div><div class="line">    <span class="comment">#第二个参数resample有四个选项，分别是Image.NEAREST、Image.BILINEAR、Image.BICUBIC、Image.LANCZOS，默认是第一个，第四个质量最高。</span></div><div class="line">    txt = <span class="string">""</span> <span class="comment">#初始化txt</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(HEIGHT):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(WIDTH):</div><div class="line">            txt += get_char(*im.getpixel((j,i)))</div><div class="line">            <span class="comment"># get_char（r,g,b,alph）有四个参数。我们使用im.getpixel()</span></div><div class="line">            <span class="comment">#函数，是得到某坐标(j,i) 图片的RGB值，和另一个参数，跟图片类型相关</span></div><div class="line">            <span class="comment"># 即是getpixel((j,i)) 得到值(R值，G值，B值，A值) 这里A值就是色彩空间。将A值穿给</span></div><div class="line">            <span class="comment"># get_char()函数的 alph。</span></div><div class="line">            <span class="comment">#这里使用 * 号，是对元组的拆封过程，会返回对应元组的所有对象。</span></div><div class="line"></div><div class="line">        txt += <span class="string">'\n'</span></div><div class="line">    <span class="keyword">print</span> txt</div><div class="line">    <span class="keyword">if</span> OUTPUT:</div><div class="line">        <span class="keyword">with</span> open(OUTPUT,<span class="string">'w'</span>) <span class="keyword">as</span> f:</div><div class="line">            f.write(txt)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">with</span> open(<span class="string">"output.txt"</span>,<span class="string">'w'</span>) <span class="keyword">as</span> f:</div><div class="line">            f.write(txt)</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>网上问题答疑:</p>
<ol>
<li><code>*im.getpixel((j, i))</code>返回的是什么？为什么要加“ <em> ”？<br>答:返回的是一个元组，这个元组有三个元素，分别对应三个颜色通道（RGB）的值。<br>`</em><code>是一个运算符，对元组使用</code><em><code>运算符即为元组拆封操作。元组拆封会返回元祖的所有元素。
所以表达式</code></em>im.getpixel((j,i))` 返回 3 个值，正好对应 get_char() 函数的三个参数。还有一个值就是对应的get_char()的alph值</li>
<li><code>im = im.resize((WIDTH, HEIGHT), Image.NEAREST)</code>，这里的Image.NEAREST和resize函数是什么意思?<br>答；返回的4个值为:<br> PIL.Image.NEAREST (use nearest neighbour),<br> PIL.Image.BILINEAR (linear interpolation),<br> PIL.Image.BICUBIC (cubic spline interpolation),<br> PIL.Image.LANCZOS (a high-quality downsampling filter)</li>
<li>另答案:<br><code>getpixel</code> : 返回指定位置的像素，如果所打开的图像是多层次的图片，那这个方法就返回一个元组。<br><code>im.getpixel( xy ) =&gt; value or tuple</code><br>本实验中的函数，我的理解是，图片模式应该是RGBA:4元素元组，<br>而且：<code>def get_char(r,g,b,alpha = 256)</code>，这个函数里边也是4个参数。<br>然后，说下我对这个程序的理解：<br>`txt += get_char(im.getpixel((j,i)))``<br>这个函数，首先调用了im.getpixel函数，im.getpixel的参数是（j,i）。（j,i）其实是图片的横纵坐标。通过调用这个函数，把图片的横纵坐标上的颜色，分割成了(r,g,b,alpha)这个四个参数，然后调用get_char这个函数。<br>再说下get_char这个函数是怎么运行的。<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_char</span><span class="params">(r,g,b,alpha = <span class="number">256</span>)</span>:</span></div><div class="line"><span class="keyword">if</span> alpha == <span class="number">0</span>: //如果alpha等于<span class="number">0</span>，也就是判断图片现在是不是没有了。</div><div class="line"><span class="keyword">return</span> <span class="string">' '</span></div><div class="line">length = len(ascii_char)//就是上边那一串字符串的长度</div><div class="line">gray = int(<span class="number">0.2126</span> r + <span class="number">0.7152</span> g + <span class="number">0.0722</span> b) //灰度的计算公式</div><div class="line"><span class="comment">#####另外：</span></div><div class="line">unit = (<span class="number">256.0</span> + <span class="number">1</span>)/length</div><div class="line"><span class="keyword">return</span> ascii_char[int(gray/unit)]  //其实这个就是gray*length/<span class="number">257</span>，这个公式相当于按照灰度，在那串字符串中选一个字母。。。</div></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/17/vim-use/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/17/vim-use/" itemprop="url">
                  vim_use
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-17T11:47:27+08:00">
                2017-08-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="vim-编辑器的使用"><a href="#vim-编辑器的使用" class="headerlink" title="vim 编辑器的使用"></a>vim 编辑器的使用</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>在日常运维工作中，非常平凡的接触vim编辑器。对vim编辑器的熟悉，是非常重要的事情，往往会大大提高我们的工作效率</p>
<h2 id="vim编辑器的模式"><a href="#vim编辑器的模式" class="headerlink" title="vim编辑器的模式"></a>vim编辑器的模式</h2><p>vim一共有6中模式。但是我们常用的只有 <strong>普通模式</strong>，<strong>编辑模式</strong>，<strong>命令行模式</strong>。只需要了解这几个模式就可以了。</p>
<h3 id="普通模式"><a href="#普通模式" class="headerlink" title="普通模式"></a>普通模式</h3><p>我们使用vim text.txt 进入后，就是默认的普通模式，这里面可以执行光标的移动，内容（对象）的删除的操作。<br>比如：</p>
<ul>
<li><code>yy</code> 复制光标当前行，  <code>2yy</code>就是 复制光标当前2行</li>
<li><code>p</code> 在光标下一行粘贴复制的内容</li>
<li><code>dd</code> 删除光标当前行，  <code>2dd</code>  删除光标一下多少行。<code>d</code>为删除操作，如果你按<code>d</code>,在按下光标，就会删除2行，相当于：<code>2dd</code><h3 id="编辑模式"><a href="#编辑模式" class="headerlink" title="编辑模式"></a>编辑模式</h3>在普通模式下，按<code>i</code> 或者<code>a</code>进入编辑模式。在编辑模式里，可以编辑文本。<br>返回到普通模式按<code>esc</code> 大写的I和A 分别表示在行首和行末插入。<h3 id="命令行模式"><a href="#命令行模式" class="headerlink" title="命令行模式"></a>命令行模式</h3>进入命令行模式，在普通模式下，执行命令按：<code>:+命令</code> 搜索按:<code>/+命令</code> 或者<code>?+命令</code><br>过滤命令(<code>!</code>键)。在命令完成之后，回到原来的模式，通常我普通模式<h2 id="vim退出"><a href="#vim退出" class="headerlink" title="vim退出"></a>vim退出</h2><h3 id="命令退出"><a href="#命令退出" class="headerlink" title="命令退出"></a>命令退出</h3>vim退出有以下几种方式：<br><code>:q!</code> 强制退出，不保存<br><code>:q</code>  退出<br><code>:wq!</code>  强制保存并退出<br><code>:w &lt;文件路径&gt;</code> 文件另存为<br><code>:saveas &lt;文件路径&gt;</code> 文件另存为<br><code>:x</code>  保存并退出<br><code>:wq</code>  保存并退出 <h3 id="快捷键退出"><a href="#快捷键退出" class="headerlink" title="快捷键退出"></a>快捷键退出</h3>在普通模式下 <code>shift + zz</code> 保存并退出<h2 id="常用的vim命令"><a href="#常用的vim命令" class="headerlink" title="常用的vim命令"></a>常用的vim命令</h2><h3 id="删除命令"><a href="#删除命令" class="headerlink" title="删除命令:"></a>删除命令:</h3><code>.</code> 重复上一次命令<br><code>x</code> 普通模式下输入<code>x</code>,删除第一个字符<h3 id="文本跳转"><a href="#文本跳转" class="headerlink" title="文本跳转"></a>文本跳转</h3><code>10x</code> 连续删除10个字符<br><code>3dd</code> 连续删除3行<br><code>nG</code> 光标移动到地几行，或者 <code>: 10 G</code><br><code>gg</code> 光标移动到首行<br><code>G</code> 光标移动到尾行<br><code>:set nu</code>  设置显示行号<h3 id="行内跳转"><a href="#行内跳转" class="headerlink" title="行内跳转"></a>行内跳转</h3><code>w</code> 到下一个单词开头<br><code>e</code> 到下一个单词开头<br><code>b</code> 到下一个单词开头<br><code>ge</code> 到下一个单词开头<br><code>0或^</code> 到下一个单词开头<br><code>$</code> 到下一个单词开头<br><code>f&lt;字母&gt;</code> 向后搜字母，并跳到第一个匹配之前的文章<h3 id="复制粘贴"><a href="#复制粘贴" class="headerlink" title="复制粘贴"></a>复制粘贴</h3></li>
<li>普通模式中，<code>yy</code>复制游标所在的整行（<code>3yy</code>表示复制3行）</li>
<li>普通模式中，<code>y^</code> 复制至行首，或<code>y0</code>。不含光标所在处字符。</li>
<li>普通模式中，<code>y$</code> 复制至行尾。含光标所在处字符。</li>
<li>普通模式中，<code>yw</code>复制一个单词。</li>
<li>普通模式中，<code>y2w</code>复制两个单词。</li>
<li>普通模式中，<code>yG</code>复制至文本末。</li>
<li>普通模式中，<code>y1G</code>复制至文本开头。<br><strong>粘贴</strong></li>
<li>普通模式中，<code>p</code>(小写)代表粘贴至光标后（下）</li>
<li>普通模式中，<code>P</code>(大写)代表粘贴至光标前（上）<br><strong>剪切</strong><br>其实前面讲得<code>dd</code>删除命令就是剪切，你每次<code>dd</code>删除文档内容后，便可以使用p来粘贴，也这一点可以让我们实现一个很爽快的功能——交换上下行：</li>
</ul>
<p><code>ddp</code>,就这么简单，即实现了快速交换光标所在行与它下面的行</p>
<h3 id="替换和撤销操作"><a href="#替换和撤销操作" class="headerlink" title="替换和撤销操作"></a>替换和撤销操作</h3><p><code>r+&lt;待替换字母&gt;</code>  将游标所在字母替换为指定字母<br><code>R</code>   连续替换，直到按下<code>Esc</code><br><code>u{n}</code>   撤销一次或n次操作<br><code>U(大写)</code>   撤销当前行的所有修改<br><code>Ctrl+r</code>  redo，即撤销undo的操作</p>
<h3 id="快速缩进"><a href="#快速缩进" class="headerlink" title="快速缩进"></a>快速缩进</h3><p>普通模式下输入 <code>15G</code>，跳转到15行<br>普通模式下输入 <code>&gt;&gt;</code> 整行将向右缩进（使用，用于格式化代码超爽）<br>普通模式下输入 <code>&lt;&lt;</code> 整行向左回退<br>普通模式下输入 <code>:</code> 进入命令行模式下对shiftwidth值进行设置可以控制缩进和回退的字符数</p>
<h3 id="shiftwidth命令"><a href="#shiftwidth命令" class="headerlink" title="shiftwidth命令"></a>shiftwidth命令</h3><p>shiftwidth命令是指上一节<code>&gt;&gt;</code>命令产生的缩进（可以简写成sw）<br>普通模式下输入:进入命令行模式下对shiftwidth值进行设置可以控制缩进和回退的字符数<br>获取目前的设定值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">:set shiftwidth?</div></pre></td></tr></table></figure></p>
<p>设置缩进的10个字符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">:set shiftwidth=10</div></pre></td></tr></table></figure></p>
<h3 id="设置文件为准"><a href="#设置文件为准" class="headerlink" title="设置文件为准"></a>设置文件为准</h3><ul>
<li>命令行模式下输入:ce(center)命令使本行内容居中</li>
<li>命令行模式下输入:ri(right)命令使本行文本靠右</li>
<li>命令行模式下输入:le(left)命令使本行内容靠左<h2 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h2>普通模式下输入<code>/</code> 然后输入查找的值，<code>?</code>的功能相同，/是向下，?是向上<br>进入查找之后，输入<code>n</code>和<code>N</code>可以继续查找<br><code>n</code>表示继续查找，<code>N</code>反向查找<h2 id="常用shell-替换"><a href="#常用shell-替换" class="headerlink" title="常用shell 替换"></a>常用shell 替换</h2><code>：5，55 s/^/&quot; &gt;&gt; final.xml/g</code>     在5到55首 插入      “&gt;&gt; final.xml<br><code>：5，55 s/$/&quot; &gt;&gt; final.xml/g</code>    在5到55末 插入      “&gt;&gt; final.xml<br><code>：5，55 s/pengke/zhang/g&quot;</code>    在5到55末pegnke替换成zhang<br><code>:20, s/pengke/PENGKE/g</code>   在20到末尾 pengke替换成PENGKE<br><code>:,15 s/pengke/PENGKE/g</code>   在1到15 pengke替换成PENGKE<h2 id="高级功能"><a href="#高级功能" class="headerlink" title="高级功能"></a>高级功能</h2>多文件编辑<br>可视化模式<br>视窗操作<br>文档加密<br>在vim中执行外部命令<br>vim功能设置<br>实验楼地址：<br><a href="https://www.shiyanlou.com/courses/2/labs/19/document" target="_blank" rel="external">https://www.shiyanlou.com/courses/2/labs/19/document</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/14/auto-zabbix-agentd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/14/auto-zabbix-agentd/" itemprop="url">
                  auto_zabbix_agentd
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-14T11:34:51+08:00">
                2017-08-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="zabbix通过导入文件的方式批量添加监控"><a href="#zabbix通过导入文件的方式批量添加监控" class="headerlink" title="zabbix通过导入文件的方式批量添加监控"></a>zabbix通过导入文件的方式批量添加监控</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>由于zabbix监控系统的自动发现主机，不是很适合物联网的业务环境。每次也需要自己手动添加监控，更改主机名字。和nagios监控的工作量差不多。所以时间shell脚步完成批量主机的导入。</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><ul>
<li>首先观察原来zabbix服务器导出的xml 标准文件</li>
<li>发现，在hosts里面几个重要信息。包括（主机，主机ip，主机名字）</li>
<li>然后我用for循环，使用数据重定向。写入这些信息即可。<br>最后，改脚本方法很笨，可能在大佬们看来不值一提。不过我认为：能完成自己的功能就行。</li>
</ul>
<h3 id="核心知识"><a href="#核心知识" class="headerlink" title="核心知识"></a>核心知识</h3><p>shell的for循环:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a=10</div><div class="line">for ((i=0;i&lt;=$a;i++))</div><div class="line">do</div><div class="line">echo "Test text."</div><div class="line">done</div></pre></td></tr></table></figure></p>
<p>vi编辑器添加和插入字符串<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">:5,15 s/^/#/g     # 在5到15行首插入#注释符号</div><div class="line">:5,15 s/$/ .sh/g  # 在5到15行末插入.sh</div></pre></td></tr></table></figure></p>
<p>awk 中的print用$i代替$1 $2 等<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">a=10</div><div class="line">test="1 2 3 4 5 6 7 8 9 10 11"</div><div class="line">for ((i=1,i&lt;=$a,i++))</div><div class="line">do</div><div class="line">echo $test | awk '&#123;print i&#125;i="$i"'</div><div class="line"><span class="meta">#</span><span class="bash"> awk 就是在使用外部变量前，需要定义</span></div><div class="line">done</div></pre></td></tr></table></figure></p>
<h3 id="zabbix-监控源代码"><a href="#zabbix-监控源代码" class="headerlink" title="zabbix 监控源代码"></a>zabbix 监控源代码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></div><div class="line">head -n 10 zbx_export_hosts.xml &gt; final.xml</div><div class="line">hosts=`cat hosts`</div><div class="line">all=`echo $hosts | awk '&#123;print NF&#125;'`</div><div class="line">if [ ! -n "$1" ];then</div><div class="line">    name='no-name'</div><div class="line">else</div><div class="line">    name=$1</div><div class="line">fi</div><div class="line">for (( i=1;i&lt;=$all;i++))</div><div class="line">do</div><div class="line">    echo "        &lt;host&gt;" &gt;&gt; final.xml</div><div class="line">    a=`echo $hosts | awk '&#123;print $i&#125;' i="$i" `</div><div class="line">    echo "            &lt;host&gt;$a&lt;/host&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;name&gt;$name-$a&lt;/name&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;description/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;proxy/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;status&gt;0&lt;/status&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;ipmi_authtype&gt;-1&lt;/ipmi_authtype&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;ipmi_privilege&gt;2&lt;/ipmi_privilege&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;ipmi_username/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;ipmi_password/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;tls_connect&gt;1&lt;/tls_connect&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;tls_accept&gt;1&lt;/tls_accept&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;tls_issuer/&gt; " &gt;&gt; final.xml</div><div class="line">    echo "            &lt;tls_subject/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;tls_psk_identity/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;tls_psk/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;templates&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                &lt;template&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;name&gt;Linux-Templates&lt;/name&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                &lt;/template&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;/templates&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;groups&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                &lt;group&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;name&gt;Linux servers&lt;/name&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                &lt;/group&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;/groups&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;interfaces&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                &lt;interface&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;default&gt;1&lt;/default&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;type&gt;1&lt;/type&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;useip&gt;1&lt;/useip&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;ip&gt;$a&lt;/ip&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;dns/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;port&gt;10050&lt;/port&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;bulk&gt;1&lt;/bulk&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                    &lt;interface_ref&gt;if1&lt;/interface_ref&gt;" &gt;&gt; final.xml</div><div class="line">    echo "                &lt;/interface&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;/interfaces&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;applications/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;items/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;discovery_rules/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;macros/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "            &lt;inventory/&gt;" &gt;&gt; final.xml</div><div class="line">    echo "        &lt;/host&gt;" &gt;&gt; final.xml</div><div class="line">done</div><div class="line"></div><div class="line">tail -n 2 zbx_export_hosts.xml &gt;&gt; final.xml</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>现在初学python，忘记了很多shell的知识。这点需要加强。<br>同事用python 2.7 完成该功能的代码：值得学习：<br><a href="http://blog.hhzzer.com/2017/08/14/python%E5%88%9B%E5%BB%BAzabbix%E4%B8%BB%E6%9C%BA%E5%AF%BC%E5%85%A5xml%E4%BF%A1%E6%81%AF/" target="_blank" rel="external">http://blog.hhzzer.com/2017/08/14/python%E5%88%9B%E5%BB%BAzabbix%E4%B8%BB%E6%9C%BA%E5%AF%BC%E5%85%A5xml%E4%BF%A1%E6%81%AF/</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/10/python-12306/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/10/python-12306/" itemprop="url">
                  python_12306
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-10T10:58:31+08:00">
                2017-08-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="使用pyrhon3爬12306火车余票"><a href="#使用pyrhon3爬12306火车余票" class="headerlink" title="使用pyrhon3爬12306火车余票"></a>使用pyrhon3爬12306火车余票</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><ul>
<li>初学python2，看完了简明的python教程，是一本很好的书。然后找项目练手，准备了爬虫</li>
<li>看到了实验楼的12306余票查询的教程，就跟根据文档一步一步做。</li>
<li>在最后的阶段，由于实验楼教程过久。12306网站get到数据已经改变。网上找其他教程<br>链接：</li>
</ul>
<ol>
<li>实验楼：<a href="https://www.shiyanlou.com/courses/623/labs/2072/document" target="_blank" rel="external">https://www.shiyanlou.com/courses/623/labs/2072/document</a></li>
<li>参考的网上最新爬虫：<a href="http://blog.csdn.net/lexyhp/article/details/71108216" target="_blank" rel="external">http://blog.csdn.net/lexyhp/article/details/71108216</a> 里面还有使用的很多库的解释和源代码<h2 id="所用到-的库："><a href="#所用到-的库：" class="headerlink" title="所用到 的库："></a>所用到 的库：</h2></li>
<li>requests， 用于请求12306网站网址</li>
<li>docopt， 解析命令行参数</li>
<li>prettytable， 数据用表格的形式打印在终端</li>
<li>colorama， 为打印在表格中的数据着色<h2 id="步骤："><a href="#步骤：" class="headerlink" title="步骤："></a>步骤：</h2>其中步骤，在实验楼的文档里面非常详细。下来说说我自己的步骤。<h3 id="目的："><a href="#目的：" class="headerlink" title="目的："></a>目的：</h3>首先，你需要做什么？<br>此次目的是为了熟悉python代码。熟悉爬虫的流程。<h3 id="步骤详情："><a href="#步骤详情：" class="headerlink" title="步骤详情："></a>步骤详情：</h3><a href="https://www.shiyanlou.com/courses/623/labs/2072/document" target="_blank" rel="external">https://www.shiyanlou.com/courses/623/labs/2072/document</a></li>
</ol>
<h2 id="我的源代码："><a href="#我的源代码：" class="headerlink" title="我的源代码："></a>我的源代码：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#coding: utf-8</span></div><div class="line"><span class="string">"""命令行火车票查看器</span></div><div class="line"></div><div class="line">Usage:</div><div class="line">    tickets [-gdtkz] &lt;from&gt; &lt;to&gt; &lt;date&gt;</div><div class="line"></div><div class="line">Options:</div><div class="line">    -h,--help   显示帮助菜单</div><div class="line">    -g          高铁</div><div class="line">    -d          动车</div><div class="line">    -t          特快</div><div class="line">    -k          快速</div><div class="line">    -z          直达</div><div class="line"></div><div class="line">Example:</div><div class="line">    tickets 北京 上海 2016-10-10</div><div class="line">    tickets -dg 成都 南京 2016-10-10</div><div class="line">"""</div><div class="line"><span class="keyword">from</span> docopt <span class="keyword">import</span> docopt</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> stations <span class="keyword">import</span> stations</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">from</span> prettytable <span class="keyword">import</span> PrettyTable</div><div class="line"><span class="keyword">from</span> colorama <span class="keyword">import</span> init,Fore</div><div class="line"></div><div class="line">init()</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrainsCollection</span>:</span></div><div class="line"></div><div class="line">    header = <span class="string">'车次 车站 时间 历时 一等 二等 高级软卧 软卧 硬卧 硬座 无座'</span>.split()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, available_trains,available_place,options)</span>:</span></div><div class="line">        <span class="string">"""查询到的火车班次集合</span></div><div class="line"></div><div class="line">        :param available_trains: 一个列表, 包含可获得的火车班次, 每个</div><div class="line">                                 火车班次是一个字典</div><div class="line">        :param options: 查询的选项, 如高铁, 动车, etc...</div><div class="line">        """</div><div class="line">        self.available_trains = available_trains</div><div class="line">        self.available_place = available_place</div><div class="line">        self.options = options</div><div class="line"><span class="meta">    @property</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trains</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">for</span> raw_train <span class="keyword">in</span> self.available_trains:</div><div class="line">            raw_train_list = raw_train.split(<span class="string">'|'</span>)</div><div class="line">            <span class="comment">#print(raw_train_list)</span></div><div class="line">            train_no = raw_train_list[<span class="number">3</span>]</div><div class="line">            <span class="comment">#print(train_no)</span></div><div class="line">            initial = train_no[<span class="number">0</span>].lower()</div><div class="line">            <span class="comment">#print(initial)</span></div><div class="line">            duration = raw_train_list[<span class="number">10</span>]</div><div class="line">            <span class="keyword">if</span>  (initial <span class="keyword">in</span> self.options) <span class="keyword">or</span> (self.options == <span class="string">""</span>) :</div><div class="line">            <span class="comment">#后面这个 or 条件是我自己添加，因为如果不输入参数[-dktz]，就查不出来</span></div><div class="line">                train = [</div><div class="line">                    train_no,        </div><div class="line">                    <span class="string">'\n'</span>.join([Fore.LIGHTGREEN_EX + self.available_place[raw_train_list[<span class="number">6</span>]] + Fore.RESET,</div><div class="line">                               Fore.LIGHTRED_EX + self.available_place[raw_train_list[<span class="number">7</span>]] + Fore.RESET]),</div><div class="line">                    <span class="string">'\n'</span>.join([Fore.LIGHTGREEN_EX + raw_train_list[<span class="number">8</span>] + Fore.RESET,</div><div class="line">                               Fore.LIGHTRED_EX + raw_train_list[<span class="number">9</span>] + Fore.RESET]),</div><div class="line">                    duration,</div><div class="line">                    raw_train_list[<span class="number">-4</span>] <span class="keyword">if</span> raw_train_list[<span class="number">-4</span>] <span class="keyword">else</span> <span class="string">'--'</span>,</div><div class="line">                    raw_train_list[<span class="number">-5</span>] <span class="keyword">if</span> raw_train_list[<span class="number">-5</span>] <span class="keyword">else</span> <span class="string">'--'</span>,</div><div class="line">                    raw_train_list[<span class="number">-14</span>] <span class="keyword">if</span> raw_train_list[<span class="number">-14</span>] <span class="keyword">else</span> <span class="string">'--'</span>,</div><div class="line">                    raw_train_list[<span class="number">-12</span>] <span class="keyword">if</span> raw_train_list[<span class="number">-12</span>] <span class="keyword">else</span> <span class="string">'--'</span>,</div><div class="line">                    raw_train_list[<span class="number">-7</span>] <span class="keyword">if</span> raw_train_list[<span class="number">-7</span>] <span class="keyword">else</span> <span class="string">'--'</span>,</div><div class="line">                    raw_train_list[<span class="number">-6</span>] <span class="keyword">if</span> raw_train_list[<span class="number">-6</span>] <span class="keyword">else</span> <span class="string">'--'</span>,</div><div class="line">                    raw_train_list[<span class="number">-9</span>] <span class="keyword">if</span> raw_train_list[<span class="number">-9</span>] <span class="keyword">else</span> <span class="string">'--'</span>,</div><div class="line">                ]</div><div class="line">                <span class="comment">#print(train[:])</span></div><div class="line">                <span class="keyword">yield</span> train</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pretty_print</span><span class="params">(self)</span>:</span></div><div class="line">        pt = PrettyTable()</div><div class="line">        pt._set_field_names(self.header)</div><div class="line">        <span class="keyword">for</span> train <span class="keyword">in</span> self.trains:</div><div class="line">            pt.add_row(train)</div><div class="line">        print(pt)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">cli</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">"""command-line interface"""</span></div><div class="line">    arguments = docopt(__doc__) <span class="comment">#__doc__是出去当前对象的帮助文档</span></div><div class="line">    <span class="comment">#   print(arguments)#是返回一个字典</span></div><div class="line">    from_station = stations.get(arguments[<span class="string">'&lt;from&gt;'</span>])</div><div class="line">    to_station = stations.get(arguments[<span class="string">'&lt;to&gt;'</span>])</div><div class="line">    date = arguments[<span class="string">'&lt;date&gt;'</span>]</div><div class="line">    url = <span class="string">'https://kyfw.12306.cn/otn/leftTicket/query?leftTicketDTO.train_date=&#123;&#125;&amp;leftTicketDTO.from_station=&#123;&#125;&amp;leftTicketDTO.to_station=&#123;&#125;&amp;purpose_codes=ADULT'</span>.format(date, from_station, to_station)</div><div class="line">    options= <span class="string">''</span>.join([key <span class="keyword">for</span> key, value <span class="keyword">in</span> arguments.items() <span class="keyword">if</span> value <span class="keyword">is</span> <span class="keyword">True</span>])</div><div class="line">    <span class="comment"># 获取参数</span></div><div class="line">    <span class="comment"># 添加verify=False 参数不验证证书</span></div><div class="line">    r=requests.get(url, verify=<span class="keyword">False</span>)</div><div class="line">    <span class="comment">#print(r.json())</span></div><div class="line">    <span class="comment">#r = requests.get(url);</span></div><div class="line">    available_trains = r.json()[<span class="string">'data'</span>][<span class="string">'result'</span>]</div><div class="line">    available_place = r.json()[<span class="string">'data'</span>][<span class="string">'map'</span>]</div><div class="line">    <span class="comment">#print(available_trains[:])</span></div><div class="line">    <span class="comment">#a=''.join(available_trains[:])</span></div><div class="line">    <span class="comment">#print(a.split("|"))</span></div><div class="line">    <span class="comment">#Trainsconllection(available_trains, options).pretty_print()</span></div><div class="line">    TrainsCollection(available_trains,available_place,options).pretty_print()</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    cli()</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/26/sublime-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/26/sublime-install/" itemprop="url">
                  sublime_install
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-26T10:42:34+08:00">
                2017-07-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>最近学习python，使用sublime text3 编辑器。真的很方便和好用.可以安装很多插件，来选择自己想要的编译系统<br><strong>注意：</strong>最好不要在百度下破解版，不然安装<code>Package Control</code>组件各种问题。</p>
<h2 id="安装subleme-text3"><a href="#安装subleme-text3" class="headerlink" title="安装subleme text3"></a>安装subleme text3</h2><p>在官网下载，直接安装。</p>
<h2 id="配置sublime的插件"><a href="#配置sublime的插件" class="headerlink" title="配置sublime的插件"></a>配置sublime的插件</h2><p>配置插件我们使用<code>Package Control</code>工具。非常方便自动安装和管理，设置插件。<br>以下是安装步骤：</p>
<h3 id="自动安装Package-Control工具或者手动安装"><a href="#自动安装Package-Control工具或者手动安装" class="headerlink" title="自动安装Package Control工具或者手动安装"></a>自动安装Package Control工具或者手动安装</h3><p>自动安装：<br>官网有详细教程：<a href="https://packagecontrol.io/installation" target="_blank" rel="external">https://packagecontrol.io/installation</a></p>
<ol>
<li>打开sublime 使用<code>ctrl+\``或者</code>View &gt; Show Console`</li>
<li>输入以下代码：完成自动安装。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">import urllib.request,os,hashlib; h = &apos;df21e130d211cfc94d9b0905775a7c0f&apos; + &apos;1e3d39e33b79698005270310898eea76&apos;; pf = &apos;Package Control.sublime-package&apos;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( &apos;http://packagecontrol.io/&apos; + pf.replace(&apos; &apos;, &apos;%20&apos;)).read(); dh = hashlib.sha256(by).hexdigest(); print(&apos;Error validating download (got %s instead of %s), please try manual install&apos; % (dh, h)) if dh != h else open(os.path.join( ipp, pf), &apos;wb&apos; ).write(by)</div></pre></td></tr></table></figure>
</li>
</ol>
<p>如果自动安装失败，需要手动安装。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">1. Click the Preferences &gt; Browse Packages… menu </div><div class="line">2. Browse up a folder and then into the Installed Packages/ folder </div><div class="line">3. Download Package Control.sublime-package and copy it into the Installed Packages/ directory </div><div class="line">4. Restart Sublime Text</div></pre></td></tr></table></figure></p>
<h2 id="通过Package-Control工具安装插件"><a href="#通过Package-Control工具安装插件" class="headerlink" title="通过Package Control工具安装插件"></a>通过Package Control工具安装插件</h2><p>我一共安装了几个插件，网上说写python非常有用。插件如下：</p>
<ul>
<li>anaconda 这个是代码提示，idte等很强大的工具</li>
<li>package control  这个是管理工具</li>
<li>sidebarenhancements 这个可以新建文件</li>
<li>sublimecodelntel   这个是代码自动提示</li>
<li>sublimerepl  这个是sublime的主题是</li>
<li>sublimetmpl 这个是新建文件模板<h3 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h3></li>
</ul>
<ol>
<li>按下Ctrl+Shift+P调出命令面板</li>
<li>输入install 调出 Install Package 选项并回车，然后在列表中选中要安装的插件。<br>直接搜索需要安装的插件点击即可。<br>或者：<br><code>preferences-&gt;package control-&gt;install package</code><br>其中<br>卸载，查看，设置插件都可以在这里面看到。<h2 id="配置anaconda插件"><a href="#配置anaconda插件" class="headerlink" title="配置anaconda插件"></a>配置anaconda插件</h2>由于，安装这个插件后，非常多的警告出现，我们需要关掉这些。</li>
<li>在菜单中Preferences &gt;&gt; Package Settings中打开Anaconda的user settings配置文件。</li>
<li>在上述配置文件中加入以下内容，并保存。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123; </div><div class="line">	&quot;anaconda_linting&quot;: false, </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="配置sublimerepl插件，就是python的idte"><a href="#配置sublimerepl插件，就是python的idte" class="headerlink" title="配置sublimerepl插件，就是python的idte"></a>配置sublimerepl插件，就是python的idte</h2><h2 id="可以使用的license"><a href="#可以使用的license" class="headerlink" title="可以使用的license"></a>可以使用的license</h2><p>不要复制–里面的内容<br>第一个：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">—– BEGIN LICENSE —–</div><div class="line">Michael Barnes</div><div class="line">Single User License</div><div class="line">EA7E-821385</div><div class="line">8A353C41 872A0D5C DF9B2950 AFF6F667</div><div class="line">C458EA6D 8EA3C286 98D1D650 131A97AB</div><div class="line">AA919AEC EF20E143 B361B1E7 4C8B7F04</div><div class="line">B085E65E 2F5F5360 8489D422 FB8FC1AA</div><div class="line">93F6323C FD7F7544 3F39C318 D95E6480</div><div class="line">FCCC7561 8A4A1741 68FA4223 ADCEDE07</div><div class="line">200C25BE DBBC4855 C4CFB774 C5EC138C</div><div class="line">0FEC1CEF D9DCECEC D3A5DAD1 01316C36</div><div class="line">—— END LICENSE ——</div></pre></td></tr></table></figure></p>
<p>第二个：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">—– BEGIN LICENSE —–</div><div class="line">Alexey Plutalov</div><div class="line">Single User License</div><div class="line">EA7E-860776</div><div class="line">3DC19CC1 134CDF23 504DC871 2DE5CE55</div><div class="line">585DC8A6 253BB0D9 637C87A2 D8D0BA85</div><div class="line">AAE574AD BA7D6DA9 2B9773F2 324C5DEF</div><div class="line">17830A4E FBCF9D1D 182406E9 F883EA87</div><div class="line">E585BBA1 2538C270 E2E857C2 194283CA</div><div class="line">7234FF9E D0392F93 1D16E021 F1914917</div><div class="line">63909E12 203C0169 3F08FFC8 86D06EA8</div><div class="line">73DDAEF0 AC559F30 A6A67947 B60104C6</div><div class="line">—— END LICENSE ——</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="ZingsMan" />
          <p class="site-author-name" itemprop="name">ZingsMan</p>
           
              <p class="site-description motion-element" itemprop="description">业精于勤荒于嬉,行成于思毁于随。</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zingsman" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/zingsman" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/zingsman" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZingsMan</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  

  

</body>
</html>
