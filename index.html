<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="业精于勤荒于嬉,行成于思毁于随。">
<meta property="og:type" content="website">
<meta property="og:title" content="ZingsMan">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="ZingsMan">
<meta property="og:description" content="业精于勤荒于嬉,行成于思毁于随。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZingsMan">
<meta name="twitter:description" content="业精于勤荒于嬉,行成于思毁于随。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> ZingsMan </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZingsMan</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-search">
          <a href="/search" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-search"></i> <br />
            
            搜索
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/19/ansible学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/19/ansible学习/" itemprop="url">
                  ansible学习
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-19T11:58:03+08:00">
                2017-07-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h2><h3 id="1-1-centos-7-系列-系统安装"><a href="#1-1-centos-7-系列-系统安装" class="headerlink" title="1.1 centos 7 系列 系统安装"></a>1.1 centos 7 系列 系统安装</h3><p>前提，尽量使用yum安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">yum install epel-release</div><div class="line">yum install ansible -y</div><div class="line">yum install python-pip</div><div class="line">pip install ansible</div><div class="line">pip install --upgrade setuptools</div></pre></td></tr></table></figure></p>
<h3 id="1-2-ubuntu-系统"><a href="#1-2-ubuntu-系统" class="headerlink" title="1.2 ubuntu 系统"></a>1.2 ubuntu 系统</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo apt-add-repository -y ppa:ansible/ansible</div><div class="line">sudo apt-get update</div><div class="line">sudo apt-get install -y ansible</div></pre></td></tr></table></figure>
<h3 id="1-3-安装成功后简单配置"><a href="#1-3-安装成功后简单配置" class="headerlink" title="1.3  安装成功后简单配置"></a>1.3  安装成功后简单配置</h3><p>安装成功后，配偶文件在:  /etc/ansible/目录下，其中默认的hosts文件也在里面。<br>安装成功后，默认是用key登录，我们改成密码的方式、就需要在hosts文件添加远程用户名和密码：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[test]</div><div class="line">192.168.13.130</div><div class="line">[test:vars]</div><div class="line">ansible_ssh_user=app</div><div class="line">ansible_ssh_pass=app_!QAZxsw2</div></pre></td></tr></table></figure></p>
<p>测试代码: <code>ansible all -a &quot;/bin/echo hello&quot;</code><br>若使用ssh-key登陆，配置如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ ssh-agent bash</div><div class="line">$ ssh-add ~/.ssh/id_rsa</div></pre></td></tr></table></figure></p>
<p>如果不想使用 ssh-agent, 想通过密码验证的方式使用 SSH,<br>可以在执行ansible命令时使用 <code>-k</code> 参数选项, 但这里建议使用 ssh-agent.</p>
<h2 id="2-简单使用"><a href="#2-简单使用" class="headerlink" title="2. 简单使用"></a>2. 简单使用</h2><p>官方文档：<a href="http://www.ansible.com.cn/docs/intro_inventory.html" target="_blank" rel="external">http://www.ansible.com.cn/docs/intro_inventory.html</a></p>
<h3 id="2-1-Inventory文件"><a href="#2-1-Inventory文件" class="headerlink" title="2.1 Inventory文件"></a>2.1 Inventory文件</h3><p>Inventory文件 ： 就是主机清单。里面记录着主机组中的多台主机。 已经变量。默认在<code>/etc/ansible/hosts</code>中。<br>例子:  hosts文件内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">10.10.10.10:2222 #若不是默认的22端口</div><div class="line">[webservers]  #主机组名</div><div class="line">foo.example.com</div><div class="line">bar.example.com</div><div class="line"></div><div class="line">[dbservers]   #主机组名</div><div class="line">one.example.com</div><div class="line">two.example.com</div><div class="line">three.example.com</div><div class="line"></div><div class="line">[test]   #主机组名</div><div class="line">192.168.13.130</div><div class="line">[test:vars]    #主机组里面的变量</div><div class="line">ansible_ssh_user=app</div><div class="line">ansible_ssh_pass=app_!QAZxsw2</div></pre></td></tr></table></figure></p>
<p>将变量定义在，其他文件中，host文件包含定义变量的文件<br>参考链接：<a href="http://www.ansible.com.cn/docs/intro_inventory.html" target="_blank" rel="external">http://www.ansible.com.cn/docs/intro_inventory.html</a></p>
<h3 id="2-2-支持主机组里面的变量如下："><a href="#2-2-支持主机组里面的变量如下：" class="headerlink" title="2.2 支持主机组里面的变量如下："></a>2.2 支持主机组里面的变量如下：</h3><p>inventory文件的参数（组变量）如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">ansible_ssh_host</div><div class="line">      #将要连接的远程主机名.与你想要设定的主机的别名不同的话,可通过此变量设置.</div><div class="line"></div><div class="line">ansible_ssh_port</div><div class="line">      #ssh端口号.如果不是默认的端口号,通过此变量设置.</div><div class="line"></div><div class="line">ansible_ssh_user</div><div class="line">      #默认的 ssh 用户名</div><div class="line"></div><div class="line">ansible_ssh_pass</div><div class="line">      #ssh 密码(这种方式并不安全,我们强烈建议使用 --ask-pass 或 SSH 密钥)</div><div class="line"></div><div class="line">ansible_sudo_pass</div><div class="line">      #sudo 密码(这种方式并不安全,我们强烈建议使用 --ask-sudo-pass)</div><div class="line"></div><div class="line">ansible_sudo_exe (new in version 1.8)</div><div class="line">      #sudo 命令路径(适用于1.8及以上版本)</div><div class="line"></div><div class="line">ansible_connection</div><div class="line">      #与主机的连接类型.比如:local, ssh 或者 paramiko. Ansible 1.2 以前默认使用</div><div class="line">      # paramiko.1.2 以后默认使用 &apos;smart&apos;,&apos;smart&apos; 方式会根据是否</div><div class="line">      #支持ControlPersist, 来判断&apos;ssh&apos; 方式是否可行.</div><div class="line"></div><div class="line">ansible_ssh_private_key_file</div><div class="line">      #ssh 使用的私钥文件.适用于有多个密钥,而你不想使用 SSH 代理的情况.</div><div class="line"></div><div class="line">ansible_shell_type</div><div class="line">      #目标系统的shell类型.默认情况下,命令的执行使用 &apos;sh&apos; 语法,</div><div class="line">      #可设置为 &apos;csh&apos; 或 &apos;fish&apos;.</div><div class="line"></div><div class="line">ansible_python_interpreter</div><div class="line">      #目标主机的 python 路径.适用于的情况: 系统中有多个 Python, </div><div class="line">      #或者命令路径不是&quot;/usr/bin/python&quot;,比如  \*BSD, 或者 /usr/bin/python</div><div class="line">      #不是 2.X 版本的 Python.我们不使用 &quot;/usr/bin/env&quot; 机制,</div><div class="line">      #因为这要求远程用户的路径设置正确,且要求 &quot;python&quot; 可执行程序名不可</div><div class="line">      #为 python以外的名字(实际有可能名为python26).</div><div class="line">      #与 ansible_python_interpreter 的工作方式相同,</div><div class="line">      #可设定如 ruby 或 perl 的路径....</div></pre></td></tr></table></figure></p>
<p>以上是静态的inventory 文件，也可以是inventory 动态文件，保存在数据库中等<br>例如： 配置管理数据库工具：  ansible-cmdb  这个很重要，可以通过web方式，显示出来<br>参考链接：<a href="http://www.ansible.com.cn/docs/intro_dynamic_inventory.html" target="_blank" rel="external">http://www.ansible.com.cn/docs/intro_dynamic_inventory.html</a><br>参考链接：<a href="http://www.ansible.com.cn/docs/developing_inventory.html" target="_blank" rel="external">http://www.ansible.com.cn/docs/developing_inventory.html</a></p>
<h3 id="2-3-patterns-（模式）"><a href="#2-3-patterns-（模式）" class="headerlink" title="2.3 patterns  （模式）"></a>2.3 patterns  （模式）</h3><p>它就是 不用playbooks，直接用ansible执行一系列命令<br>在Ansible中,Patterns 是指我们怎样确定由哪一台主机来管理. 意思就是与哪台主机进行交互.<br>但是在:doc:playbooks 中它指的是对应主机应用特定的配置或执行特定进程.<br>例子：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ansible webservers -m service -a "name=httpd state=restarted"`</div><div class="line"><span class="meta">#</span><span class="bash">若多个组： 用冒号隔开，表示或， 表示在一个组，不在另一个组用：</span></div><div class="line">ansible webservers:test -m service -a "name=httpd state=restarted"</div><div class="line">ansible webservers:!test -m service -a "name=httpd state=restarted"</div><div class="line">ansible webservers:&amp;test -m service -a "name=httpd state=restarted"   #两个组的交集</div></pre></td></tr></table></figure></p>
<p>它分为两类：一个是ansilbel（Ad-Hoc） 和 playbooks（ymal文件）</p>
<h3 id="2-4-Introduction-To-Ad-Hoc-Commands"><a href="#2-4-Introduction-To-Ad-Hoc-Commands" class="headerlink" title="2.4  Introduction To Ad-Hoc Commands"></a>2.4  Introduction To Ad-Hoc Commands</h3><p>所谓 ad-hoc 命令是什么呢?</p>
<ol>
<li>这其实是一个概念性的名字,是相对于写 Ansible playbook来说的.类似于在命令行敲入shell命令和 写shell scripts两者之间的关系)…</li>
<li>如果我们敲入一些命令去比较快的完成一些事情,而不需要将这些执行的命令特别保存下来, 这样的命令就叫做 ad-hoc 命令.</li>
<li>Ansible提供两种方式去完成任务,一是 ad-hoc 命令,一是写 Ansible playbook.前者可以解决一些简单的任务, 后者解决较复杂的任务.</li>
<li>那我们会在什么情境下去使用ad-hoc 命令呢?比如说因为圣诞节要来了,想要把所有实验室的电源关闭,我们只需要执行一行命令 就可以达成这个任务,而不需要写 playbook 来做这个任务.</li>
<li><p>至于说做配置管理或部署这种事,还是要借助 playbook 来完成,<br>即使用 ‘/usr/bin/ansible-playbook’ 这个命令.</p>
<p> 比如我重启某组的主机</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ansible atlanta -a &quot;/usr/bin/foo&quot; -u username -f 10  #-f是进程数，-u后面是以某用户身份执行</div></pre></td></tr></table></figure>
</li>
</ol>
<p>如果想通过 sudo 去执行命令,如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ansible atlanta -a &quot;/usr/bin/foo&quot; -u username --sudo [--ask-sudo-pass]</div></pre></td></tr></table></figure></p>
<p>使用sudo，前提 你的-u 后面用户有sudo权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ansible atlanta -a &quot;/usr/bin/foo&quot; -u username -b -K</div></pre></td></tr></table></figure></p>
<p>2.5 常用模块介绍<br>常用模块：  </p>
<ul>
<li>第一： service command shell   就是执行一些linux shell 基本命令</li>
<li>第二： copy 用于文件的传输：<code>ansible atlanta -m copy -a &quot;src=/etc/hosts dest=/tmp/hosts&quot;</code></li>
<li>第三：file 。使用 file 模块可以做到修改文件的属主和权限,(在这里可替换为 copy 模块,是等效的):<br><code>nsible webservers -m file -a &quot;dest=/srv/foo/a.txt mode=600&quot;</code><br><code>ansible webservers -m file -a &quot;dest=/srv/foo/b.txt mode=600 owner=mdehaangroup=mdehaan&quot;</code><br>删除目录(递归的删除)和删除文件:<br><code>ansible webservers -m file -a &quot;dest=/path/to/c state=absent&quot;</code></li>
<li>第四：yum。Ansible 提供对 yum 和 apt 的支持.这里是关于 yum 的示例.<br>确认一个软件包已经安装,但不去升级它:<br><code>$ ansible webservers -m yum -a &quot;name=acme state=present&quot;</code><br>确认一个软件包的安装版本:<br><code>$ ansible webservers -m yum -a &quot;name=acme-1.5 state=present&quot;</code><br>确认一个软件包还没有安装:<br><code>$ ansible webservers -m yum -a &quot;name=acme state=absent&quot;</code><br>对于不同平台的软件包管理工具,Ansible都有对应的模块.如果没有,你也可以使用<br>command 模块去安装软件. 或者最好是来为那个软件包管理工具贡献一个相应的模块.<br>请在 mailing list 中查看相关的信息和详情.</li>
<li><p>第四： Users and Groups    –模块<br>使用 ‘user’ 模块可以方便的创建账户,删除账户,或是管理现有的账户:<br><code>$ ansible all -m user -a &quot;name=foo password=&lt;crypted password here&gt;&quot;</code><br><code>$ ansible all -m user -a &quot;name=foo state=absent&quot;</code></p>
</li>
<li><p>第五： Managing Services<br>确认某个服务在所有的webservers上都已经启动:<br><code>$ ansible webservers -m service -a &quot;name=httpd state=started&quot;</code><br>或是在所有的webservers上重启某个服务(译者注:可能是确认已重启的状态?):<br><code>$ ansible webservers -m service -a &quot;name=httpd state=restarted&quot;</code><br>确认某个服务已经停止:<br><code>$ ansible webservers -m service -a &quot;name=httpd state=stopped&quot;</code></p>
<h2 id="3-ansible的配置文件"><a href="#3-ansible的配置文件" class="headerlink" title="3. ansible的配置文件"></a>3. ansible的配置文件</h2><h3 id="3-1-ansible读取配置文件的顺序："><a href="#3-1-ansible读取配置文件的顺序：" class="headerlink" title="3.1 ansible读取配置文件的顺序："></a>3.1 ansible读取配置文件的顺序：</h3></li>
<li><ul>
<li>ANSIBLE_CONFIG (一个环境变量)</li>
</ul>
</li>
<li><ul>
<li>ansible.cfg (位于当前目录中)</li>
</ul>
</li>
<li><ul>
<li>.ansible.cfg (位于家目录中)</li>
</ul>
</li>
<li><ul>
<li>/etc/ansible/ansible.cfg<br>Ansible 将会按以上顺序逐个查询这些文件,直到找到一个为止,并且使用第一个寻找到个配置文件的配置,这些配置将不会被叠加.<br>配置文件的详细参数以及取值范围请查看<code>ansible.cfg</code><br>参考链接：<a href="https://raw.github.com/ansible/ansible/devel/examples/ansible.cfg" target="_blank" rel="external">https://raw.github.com/ansible/ansible/devel/examples/ansible.cfg</a></li>
</ul>
</li>
</ul>
<h3 id="3-2-配置文件详情："><a href="#3-2-配置文件详情：" class="headerlink" title="3.2 配置文件详情："></a>3.2 配置文件详情：</h3><p>默认的配置文件基本不用改变，我将日志打开了<br>(注意日志文件的权限。/var目录一般只能root读取，ansible是你远程登陆的用户执行)<br><a href="http://www.ansible.com.cn/docs/intro_configuration.html#ansible-managed" target="_blank" rel="external">http://www.ansible.com.cn/docs/intro_configuration.html#ansible-managed</a></p>
<h2 id="4-windows-支持"><a href="#4-windows-支持" class="headerlink" title="4. windows 支持"></a>4. windows 支持</h2><p>Ansible仍然通过一台Linux系统机器来进行集中管理,使用Python的 “winrm” 模块来和远程主机交互.<br>建议先学习playbooks<br><a href="https://github.com/ansible/ansible-examples" target="_blank" rel="external">https://github.com/ansible/ansible-examples</a>   一些例子</p>
<h2 id="5-playbook学习"><a href="#5-playbook学习" class="headerlink" title="5. playbook学习"></a>5. playbook学习</h2><p>playbook 由一个或多个 ‘plays’ 计划组成.它的内容是一个以 ‘plays’ 为元素的列表.在 play 之中,一组机器被映射为定义好的角色.在 ansible 中,play 的内容,被称为 tasks,即任务.在基本层次的应用中,一个任务是一个对 ansible 模块的调用。<br>plays 是playbook的一个核心内脏。  一个playbook 执行多个任务，就是多个plays</p>
<p>下面是只有一个plays情况； <code>注意:</code> <strong>一个name下面只能执行一个模块(一个action)</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">- hosts: webservers</div><div class="line">  vars:</div><div class="line">    http_port: 80</div><div class="line">    max_clients: 200</div><div class="line">  remote_user: root</div><div class="line">  tasks:</div><div class="line">  - name: ensure apache is at the latest version</div><div class="line">    yum: pkg=httpd state=latest</div><div class="line">  - name: write the apache config file</div><div class="line">    template: src=/srv/httpd.j2 dest=/etc/httpd.conf</div><div class="line">    notify:</div><div class="line">    - restart apache</div><div class="line">  - name: ensure apache is running</div><div class="line">    service: name=httpd state=started</div><div class="line">  handlers:</div><div class="line">    - name: restart apache</div><div class="line">      service: name=httpd state=restarted</div></pre></td></tr></table></figure></p>
<p>层次关系：  playbook-&gt;plays-&gt;tast-&gt;name(只能执行一个模块（action）)</p>
<h3 id="5-1-playbook基础"><a href="#5-1-playbook基础" class="headerlink" title="5.1 playbook基础"></a>5.1 playbook基础</h3><p>主机与用户<br>你可以为 playbook 中的每一个 play,个别地选择操作的目标机器是哪些,<br>以哪个用户身份去完成要执行的步骤（called tasks）.<br>hosts 行的内容是一个或多个组或主机的 patterns,以逗号为分隔符,详见 Patterns 章节.<br>remote_user 就是账户名:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">- hosts: webservers</div><div class="line">  remote_user: root</div></pre></td></tr></table></figure></p>
<p>再者,在每一个 task 中,可以定义自己的远程用户:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">- hosts: webservers</div><div class="line">  remote_user: root</div><div class="line">  tasks:</div><div class="line">    - name: test connection</div><div class="line">      ping:</div><div class="line">      remote_user: yourname</div></pre></td></tr></table></figure></p>
<p>也支持从 sudo 执行命令:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">- hosts: webservers</div><div class="line">  remote_user: yourname</div><div class="line">  sudo: yes</div></pre></td></tr></table></figure></p>
<p>同样的,你可以仅在一个 task 中,使用 sudo 执行命令,而不是在整个 play 中使用 sudo:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">- hosts: webservers</div><div class="line">  remote_user: yourname</div><div class="line">  tasks:</div><div class="line">    - service: name=nginx state=started</div><div class="line">      sudo: yes</div></pre></td></tr></table></figure></p>
<p>你也可以登陆后,sudo 到不同的用户身份,而不是使用 root:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">- hosts: webservers</div><div class="line">  remote_user: yourname</div><div class="line">  sudo: yes</div><div class="line">  sudo_user: postgres</div></pre></td></tr></table></figure></p>
<p>如果你需要在使用 sudo 时指定密码,可在运行 ansible-playbook 命令时加上选项 <code>--ask-sudo-pass</code>这个参数 就是等于  (-K). 参数<br>如果使用 sudo 时,playbook 疑似被挂起,可能是在 sudo prompt 处被卡住,这时可执行 <code>Control + C</code>杀死卡住的任务,<br>再重新运行一次.</p>
<h3 id="5-2-Tasks-列表"><a href="#5-2-Tasks-列表" class="headerlink" title="5.2 Tasks 列表"></a>5.2 Tasks 列表</h3><p>每一个 play 包含了一个 task 列表（任务列表）.一个 task 在其所对应的所有主机上（通过 host pattern 匹配的所有主机）执行完毕之后,下一个 task 才会执行.<br>在运行 playbook 时（从上到下执行）,如果一个 host 执行 task 失败,这个 host 将会从整个 playbook 的 rotation 中移除. 意思就是在 ; task中，<strong>一个name 只能执行一个模块shell command等</strong><br>每一个 task 必须有一个名称 name,这样在运行 playbook 时,从其输出的任务执行信息中可以很好的辨别出是属于哪一个 task 的.<br>如果没有定义 name,‘action’ 的值将会用作输出信息中标记特定的 task</p>
<p>test的定义：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">tasks:</div><div class="line">  - name: make sure apache is running</div><div class="line">    service: name=httpd state=running</div><div class="line"></div><div class="line">tasks:</div><div class="line">  - name: disable selinux</div><div class="line">    command: /sbin/setenforce 0</div><div class="line"></div><div class="line">tasks:</div><div class="line">  - name: run this command and ignore the result </div><div class="line">    shell: /usr/bin/somecommand</div><div class="line">    ignore_errors: True                   #忽略错误</div></pre></td></tr></table></figure></p>
<p>在 action 行中可以使用变量.假设在 ‘vars’ 那里定义了一个变量 ‘vhost’ ,可以这样使用它:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">tasks:</div><div class="line">  - name: create a virtual host file for &#123;&#123; vhost &#125;&#125;</div><div class="line">    template: src=somefile.j2 dest=/etc/httpd/conf.d/&#123;&#123; vhost &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>第一次运行playbook，我的第一个playbook，重启xinetd 服务<br>命令：<code>ansible-playbook playbook.yml -i host -K</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">- hosts: tmp</div><div class="line">  remote_user: app</div><div class="line">  sudo: yes</div><div class="line">  sudo_user: root</div><div class="line">  tasks:</div><div class="line">    - service: name=xinetd state=restarted</div><div class="line">      sudo: yes</div></pre></td></tr></table></figure></p>
<h2 id="6-Playbook-角色-Roles-和-Include-语句"><a href="#6-Playbook-角色-Roles-和-Include-语句" class="headerlink" title="6. Playbook 角色(Roles) 和 Include 语句"></a>6. Playbook 角色(Roles) 和 Include 语句</h2><p>在一个基础的 playbook 中,所有的 task 都是在一个 play 中列出,稍后将介绍一种更合理的安排 task 的方式:使用 ‘include:’ 指令.<br>就是一个任务，tast，需要被多过play 或者 playbook使用，我们可以将任务tast写在文件里面，在play中用include包含它</p>
<h2 id="7-Roles-—-非常重要和方便，什么时候回来学学"><a href="#7-Roles-—-非常重要和方便，什么时候回来学学" class="headerlink" title="7. Roles   —-非常重要和方便，什么时候回来学学"></a>7. Roles   —-非常重要和方便，什么时候回来学学</h2><p>你现在已经学过 tasks 和 handlers，那怎样组织 playbook 才是最好的方式呢？简单的回答就是：<br>使用 roles ! Roles 基于一个已知的文件结构，去自动的加载某些 vars_files，tasks 以及 handlers。<br>基于 roles 对内容进行分组，使得我们可以容易地与其他用户分享 roles 。<br>这使宿主机的动态分组有了匹配的标准,即使该分组尚未在清单文件中被定义<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line"></div><div class="line"># talk to all hosts just so we can learn about them</div><div class="line">- hosts: all</div><div class="line">  tasks:</div><div class="line">     - group_by: key=os_&#123;&#123; ansible_distribution &#125;&#125;</div><div class="line"></div><div class="line"># now just on the CentOS hosts...</div><div class="line"></div><div class="line">- hosts: os_CentOS</div><div class="line">  gather_facts: False</div><div class="line">  tasks:</div><div class="line">     - # tasks that only happen on CentOS go here</div></pre></td></tr></table></figure></p>
<p>这会抛出所有基于操作系统名的分组.<br>如果需要对特定分组做设定,这也是可以的.例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line"># file: group_vars/all</div><div class="line">asdf: 10</div><div class="line"></div><div class="line">---</div><div class="line"># file: group_vars/os_CentOS</div><div class="line">asdf: 42</div></pre></td></tr></table></figure></p>
<p>顶层目录结构应当包括下列文件和目录.一个项目的结构如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">production                # inventory file for production servers 关于生产环境服务器的清单文件</div><div class="line">stage                     # inventory file for stage environment 关于 stage 环境的清单文件</div><div class="line"></div><div class="line">group_vars/</div><div class="line">   group1                 # here we assign variables to particular groups 这里我们给特定的组赋值</div><div class="line">   group2                 # &quot;&quot;</div><div class="line">host_vars/</div><div class="line">   hostname1              # if systems need specific variables, put them here 如果系统需要特定的变量,把它们放置在这里.</div><div class="line">   hostname2              # &quot;&quot;</div><div class="line"></div><div class="line">library/                  # if any custom modules, put them here (optional) 如果有自定义的模块,放在这里(可选)</div><div class="line">filter_plugins/           # if any custom filter plugins, put them here (optional) 如果有自定义的过滤插件,放在这里(可选)</div><div class="line"></div><div class="line">site.yml                  # master playbook 主 playbook</div><div class="line">webservers.yml            # playbook for webserver tier Web 服务器的 playbook</div><div class="line">dbservers.yml             # playbook for dbserver tier 数据库服务器的 playbook</div><div class="line"></div><div class="line">roles/</div><div class="line">    common/               # this hierarchy represents a &quot;role&quot; 这里的结构代表了一个 &quot;role&quot;</div><div class="line">        tasks/            #</div><div class="line">            main.yml      #  &lt;-- tasks file can include smaller files if warranted</div><div class="line">        handlers/         #</div><div class="line">            main.yml      #  &lt;-- handlers file</div><div class="line">        templates/        #  &lt;-- files for use with the template resource</div><div class="line">            ntp.conf.j2   #  &lt;------- templates end in .j2</div><div class="line">        files/            #</div><div class="line">            bar.txt       #  &lt;-- files for use with the copy resource</div><div class="line">            foo.sh        #  &lt;-- script files for use with the script resource</div><div class="line">        vars/             #</div><div class="line">            main.yml      #  &lt;-- variables associated with this role</div><div class="line">        defaults/         #</div><div class="line">            main.yml      #  &lt;-- default lower priority variables for this role</div><div class="line">        meta/             #</div><div class="line">            main.yml      #  &lt;-- role dependencies</div><div class="line"></div><div class="line">    webtier/              # same kind of structure as &quot;common&quot; was above, done for the webtier role</div><div class="line">    monitoring/           # &quot;&quot;</div><div class="line">    fooapp/               # &quot;&quot;</div></pre></td></tr></table></figure></p>
<h2 id="8-变量的定义"><a href="#8-变量的定义" class="headerlink" title="8. 变量的定义"></a>8. 变量的定义</h2><p>   可在hosts 定义  可在playbooks定义<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- hosts: webservers</div><div class="line">  vars:</div><div class="line">    http_port: 80</div></pre></td></tr></table></figure></p>
<p>在文件和roles中定义</p>
<p>使用变量 Jinja2方式<br><code>My amp goes to </code></p>
<h3 id="8-1-怎么使用变量。"><a href="#8-1-怎么使用变量。" class="headerlink" title="8.1 怎么使用变量。"></a>8.1 怎么使用变量。</h3><p>其中， <code>ansible all -m setup</code>  可以查看远程主机很多信息，可以使用和引用里面的变量。</p>
<h3 id="8-2-查看主机信息"><a href="#8-2-查看主机信息" class="headerlink" title="8.2 查看主机信息"></a>8.2 查看主机信息</h3><p> <code>ansible -i host tmp  -m setup</code><br>里面有很多变量信息，我们需要什么变量就取用就好<br>可以在playbook中这样引用以上例子中第一个硬盘的模型:<br><code></code><br>同样,作为系统报告的主机名如以下所示:<br><code></code><br>不合格的主机名显示了句号(.)之前的字符串:<br><code></code><br>在模板和条件判断(请看 playbook_conditionals )中会经常使用Facts.</p>
<h2 id="9-playbook的-条件语句（when）"><a href="#9-playbook的-条件语句（when）" class="headerlink" title="9. playbook的 条件语句（when）"></a>9. playbook的 条件语句（when）</h2><p>常常来说,一个play的结果经常取决于一个变量的值,事件（从远端系统得到事件）, 或者之前任务的结果.在有些情况下,<br>这些变量的值也会取决于其他变量. 进而,可以建立多余的组基于这些主机是否符合某些条件来操控主机, Ansible 提供了<br>很多不同选项,来控制执行流. 让我们详细看看这些都是啥.<br>when 语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">tasks:</div><div class="line">  - name: &quot;shutdown Debian flavored systems&quot;</div><div class="line">    command: /sbin/shutdown -t now</div><div class="line">    when: ansible_os_family == &quot;Debian&quot;</div></pre></td></tr></table></figure></p>
<p>使用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ansible-playbook zabbix-agent_allos.yaml -i test -b -K -C  #-C是测试看是否成功</div></pre></td></tr></table></figure></p>
<h2 id="10-标准循环-（with-itms）"><a href="#10-标准循环-（with-itms）" class="headerlink" title="10. 标准循环 （with_itms）"></a>10. 标准循环 （with_itms）</h2><p>为了保持简洁,重复的任务可以用以下简写的方式:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- name: add several users</div><div class="line">  user: name=&#123;&#123; item &#125;&#125; state=present groups=wheel</div><div class="line">  with_items:</div><div class="line">     - testuser1</div><div class="line">     - testuser2</div></pre></td></tr></table></figure></p>
<p>如果你在变量文件中或者 ‘vars’ 区域定义了一组YAML列表,你也可以这样做:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">with_items: &quot;&#123;&#123;somelist&#125;&#125;&quot;</div></pre></td></tr></table></figure></p>
<p>以上写法与下面是完全等同的:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- name: add user testuser1</div><div class="line">  user: name=testuser1 state=present groups=wheel</div><div class="line">- name: add user testuser2</div><div class="line">  user: name=testuser2 state=present groups=wheel</div></pre></td></tr></table></figure></p>
<p>或者   其中 with_itmes：是固定写发<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- name: add several users</div><div class="line">  user: name=&#123;&#123; item.name &#125;&#125; state=present groups=&#123;&#123; item.groups &#125;&#125;</div><div class="line">  with_items:</div><div class="line">    - &#123; name: &apos;testuser1&apos;, groups: &apos;wheel&apos; &#125;</div><div class="line">    - &#123; name: &apos;testuser2&apos;, groups: &apos;root&apos; &#125;</div></pre></td></tr></table></figure></p>
<p>我的循环脚本：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">- hosts: tmp</div><div class="line">  remote_user: app</div><div class="line">  sudo: yes</div><div class="line">  sudo_user: root</div><div class="line">  tasks:</div><div class="line">  - name: test</div><div class="line">    shell: echo "&#123;&#123; ansible_os_family &#125;&#125;" &gt;&gt; testdff</div><div class="line">    sudo: yes</div><div class="line">    when: ansible_os_family == "RedHat"</div><div class="line">  - name: hello_test</div><div class="line">    shell: echo "&#123;&#123; item.name &#125;&#125;" &gt;&gt; testdff</div><div class="line">    with_items:</div><div class="line">     - &#123; name: test0111111 &#125;</div><div class="line">     - &#123; name: test0222222 &#125;</div><div class="line">     - &#123; name: test0333333 &#125;</div></pre></td></tr></table></figure></p>
<h2 id="11-ymal-语法："><a href="#11-ymal-语法：" class="headerlink" title="11. ymal 语法："></a>11. ymal 语法：</h2><p>“—“代表 yaml文件的开始<br>基本的 YAML<br>对于 Ansible, 每一个 YAML 文件都是从一个列表开始. 列表中的每一项都是一个键值对, 通常它们被称为一个 “哈希” 或 “字典”. 所以, 我们需要知道如何在 YAML 中编写列表和字典.</p>
<p>YAML 还有一个小的怪癖. 所有的 YAML 文件(无论和 Ansible 有没有关系)开始行都应该是 —. 这是 YAML 格式的一部分, 表明一个文件的开始.</p>
<p>列表中的所有成员都开始于相同的缩进级别, 并且使用一个 “- “ 作为开头(一个横杠和一个空格):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line"># 一个美味水果的列表</div><div class="line">- Apple</div><div class="line">- Orange</div><div class="line">- Strawberry</div><div class="line">- Mango</div><div class="line">一个字典是由一个简单的 键: 值 的形式组成(这个冒号后面必须是一个空格):</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line"># 一位职工的记录</div><div class="line">name: Example Developer</div><div class="line">job: Developer</div><div class="line">skill: Elite</div></pre></td></tr></table></figure>
<p>字典也可以使用缩进形式来表示, 如果你喜欢这样的话:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line"># 一位职工的记录</div><div class="line">&#123;name: Example Developer, job: Developer, skill: Elite&#125;</div></pre></td></tr></table></figure></p>
<p>Ansible并不是太多的使用这种格式, 但是你可以通过以下格式来指定一个布尔值(true/fase):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line">create_key: yes</div><div class="line">needs_agent: no</div><div class="line">knows_oop: True</div><div class="line">likes_emacs: TRUE</div><div class="line">uses_cvs: false</div></pre></td></tr></table></figure></p>
<p>让我们把目前所学到的 YAML 例子组合在一起. 这些在 Ansible 中什么也干不了, 但这些格式将会给你感觉:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">---</div><div class="line"># 一位职工记录</div><div class="line">name: Example Developer</div><div class="line">job: Developer</div><div class="line">skill: Elite</div><div class="line">employed: True</div><div class="line">foods:</div><div class="line">    - Apple</div><div class="line">    - Orange</div><div class="line">    - Strawberry</div><div class="line">    - Mango</div><div class="line">languages:</div><div class="line">    ruby: Elite</div><div class="line">    python: Elite</div><div class="line">    dotnet: Lame</div></pre></td></tr></table></figure></p>
<ol>
<li>总结<br>由于公司运维已经使用到了ansible，在这里只了解了基本的playbook的when（条件）<br>我们需要了结几个大概。</li>
</ol>
<ul>
<li>ansible有两种方式 ansible 和 ansible-playbooks</li>
<li>我控制远程主机，需要定义我要控制那些主机。（写在inventory文件里面，也是hosts文件）</li>
<li>hosts主机文件里面，可以定义组。组里面可以定义一些变量。以及端口，用户和密码等</li>
<li>playbooks 的ymal文件。里面用一个<code>-</code>或者<code> </code>来控制等级。</li>
<li>playbooks 等级为:playbooks –&gt; plays –&gt;tasts –&gt; name(一个name只有一个模块) </li>
<li>在下ymal文件供使用时，我们需要常常获取远程控制主机的信息。可以通过<code>ansible -i host tmp  -m setup</code> 来获取变量名。</li>
<li>ymal文件中，使用when 来控制条件。条件控制变量通过上一条获取。</li>
<li>ymal文件中，使用with_itms来循环。</li>
<li>目前工作就使用到这些</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/10/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/10/hello-world/" itemprop="url">
                  Hello World
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-10T21:58:24+08:00">
                2017-07-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
<h3 id="Tables"><a href="#Tables" class="headerlink" title="Tables"></a>Tables</h3><table>
<thead>
<tr>
<th>name</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>xiao</td>
<td>13</td>
</tr>
<tr>
<td>ming</td>
<td>15</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/23/powerer-linux-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/23/powerer-linux-install/" itemprop="url">
                  IBM惠普powerer-linux装redhat系统
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-23T14:33:03+08:00">
                2017-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WORK/" itemprop="url" rel="index">
                    <span itemprop="name">WORK</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="寻找系统"><a href="#寻找系统" class="headerlink" title="寻找系统"></a>寻找系统</h3><p>power-linux系统是<code>ppc64le</code>系统架构，平常的X86，或者64bit架构的系统都不支持。<br>下载特定的系统<code>redhat7.2</code>下载地址，网上自行寻找。<br><code>RHEL-7.2-Server-ppc64le-dvd.iso</code></p>
<h3 id="power-linux介绍和自己理解"><a href="#power-linux介绍和自己理解" class="headerlink" title="power-linux介绍和自己理解"></a>power-linux介绍和自己理解</h3><ol>
<li>power-linux和华为服务打不通，ibm的web管理界面，远远没有华为好用和方便。</li>
<li>power-linux web管理界面上，控制台串口登录不进去系统，java总是报错。所以<br>使用了了ibmitools工具，进行串口登录。他登录方式是你的pc的cmd命令行。还是很方便。</li>
<li>听说power-linux登录web管理界面，不能远程装系统（ubuntu可以），我也没有找到挂载<br>镜像的地方。</li>
</ol>
<h3 id="ibmitools软件的使用"><a href="#ibmitools软件的使用" class="headerlink" title="ibmitools软件的使用"></a>ibmitools软件的使用</h3><ol>
<li>下载软件。百度网盘：</li>
<li>点ibmitool.exe 运行。然后点run.bat运行，自动打开cmd命令行</li>
<li>登录串口的终端就是这个cmd窗口。运行命令：<br><code>ipmitool -I lanplus -H server_ip_address -U ipmi_user -P ipmi_password sol activate</code> 其中ip是imana管理地址。用户名是登录管理界面的用户和密码。</li>
<li>登录成功，就相当于登录了串口。—就是不能挂载镜像安装。</li>
</ol>
<h3 id="power-linux装系统redhat-7-2"><a href="#power-linux装系统redhat-7-2" class="headerlink" title="power-linux装系统redhat.7.2"></a>power-linux装系统redhat.7.2</h3><p>由于发现已经重装了系统，就没有装系统。</p>
<h3 id="power-linux在线配置raid-卡"><a href="#power-linux在线配置raid-卡" class="headerlink" title="power-linux在线配置raid 卡"></a>power-linux在线配置raid 卡</h3><p>这里我们运用到工具。在系统中安装这个工具，就能命令行在线做raid<br><code>Arcconf-1.08-21385.ppc64le.rpm</code> 下载后直接 rpm -i 路径   安装即可<br>安装步骤：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#操作步骤</span></div><div class="line"><span class="comment">#1、上传raid卡管理工具安装包到系统，用rpm直接安装</span></div><div class="line">    Arcconf-1.08-21385.ppc64le.rpm</div><div class="line"><span class="comment">#2、查看raid卡信息</span></div><div class="line">   arcconf getconfig 1 |more   <span class="comment">#（注意硬盘的state mode ）</span></div><div class="line"><span class="comment">#3、一般默认前置硬盘state mode为RAW,将其改为ready。</span></div><div class="line">   arcconf task start 1 device 0 0 initialize noprompt</div><div class="line"><span class="comment">#4、创建raid</span></div><div class="line">   arcconf create 1 logicaldrive max 10 0 0 0 1 0 2 0 3 0 4 0 5 0 6 0 7 noprompt</div><div class="line"><span class="comment"># 其中 10 代表raid 10 ，后面数字就是盘符</span></div></pre></td></tr></table></figure></p>
<p><strong>注意</strong> 一定要注意盘符的查看：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#查看命令：</span></div><div class="line">arcconf getconfig 1 |more</div><div class="line"><span class="comment">#结果：</span></div><div class="line">Logical device number 1</div><div class="line">   Logical device name                      : LogicalDrv 1</div><div class="line">   Block Size of member drives              : 512 Bytes</div><div class="line">   RAID level                               : 10          <span class="comment">#代表RAID 10</span></div><div class="line">   Unique Identifier                        : B83F682D</div><div class="line">   Status of logical device                 : Optimal</div><div class="line">   Additional details                       : Quick initialized</div><div class="line">   Size                                     : 11427830 MB</div><div class="line">   Parity space                             : 11427840 MB</div><div class="line">   Stripe-unit size                         : 256 KB</div><div class="line">   Read-cache setting                       : Enabled</div><div class="line">   Read-cache status                        : On</div><div class="line">   Write-cache setting                      : Enabled</div><div class="line">   Write-cache status                       : On</div><div class="line">   Partitioned                              : Yes</div><div class="line">   Protected by Hot-Spare                   : No</div><div class="line">   Bootable                                 : No</div><div class="line">   Failed stripes                           : No</div><div class="line">   Power settings                           : Disabled</div><div class="line"></div><div class="line"><span class="comment">#单个设备信息</span></div><div class="line">----------------------------------------------------------------------</div><div class="line">Physical Device information</div><div class="line">----------------------------------------------------------------------</div><div class="line">      Device <span class="comment">#0</span></div><div class="line">         Device is a Hard drive</div><div class="line">         State                              : Online</div><div class="line">         Block Size                         : 512 Bytes</div><div class="line">         Supported                          : Yes</div><div class="line">         Programmed Max Speed               : SATA 6.0 Gb/s</div><div class="line">         Transfer Speed                     : SATA 6.0 Gb/s</div><div class="line">         Reported Channel,Device(T:L)       : 0,0(0:0)    <span class="comment">#这里0,0就是盘符</span></div><div class="line">         Reported Location                  : Enclosure 0, Slot 0(Connector 0)</div><div class="line">         Reported ESD(T:L)                  : 2,0(0:0)</div><div class="line">         Vendor                             : ATA</div></pre></td></tr></table></figure></p>
<h3 id="做好raid后就是使用part进行超过2T磁盘分区"><a href="#做好raid后就是使用part进行超过2T磁盘分区" class="headerlink" title="做好raid后就是使用part进行超过2T磁盘分区"></a>做好raid后就是使用part进行超过2T磁盘分区</h3><p>命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">parted /dev/sdd</div><div class="line">mklabel gpt</div><div class="line">yes</div><div class="line"><span class="built_in">print</span></div><div class="line">mkpart primary 0 -1</div><div class="line">i</div><div class="line"><span class="built_in">print</span></div><div class="line">quit</div><div class="line"><span class="comment"># 进行挂载和格式化</span></div><div class="line">mkfs -t xfs /dev/sdb1   <span class="comment">#可能使用mke2fs格式化，或者其他ext4系统</span></div><div class="line"><span class="comment"># 挂载</span></div><div class="line">mount /dev/sdb1 /data</div><div class="line"><span class="comment"># 更新 /etc/fstab 文件</span></div><div class="line">/dev/sdb1               /data                   xfs     defaults        0 0</div></pre></td></tr></table></figure></p>
<h3 id="然后进行最后的各项配置。"><a href="#然后进行最后的各项配置。" class="headerlink" title="然后进行最后的各项配置。"></a>然后进行最后的各项配置。</h3><p>配置包括：YUM源。用户，监控，网卡绑定等一系列操作</p>
<blockquote>
<p>这里在配置YUM源的方面。由于系统架构为ppc这种架构。以前搭建的yum源无法使用。<br>直接，将这个系统镜像里边的包解压放到yum源某个目录。<br>在客户端配置文件中。对应的url就能使用镜像yum源。</p>
</blockquote>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>后面学习看看ansible自动化工具作配置。已经公司已经写好脚本的使用。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/22/yum-config/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/22/yum-config/" itemprop="url">
                  内网yum源配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-22T15:15:43+08:00">
                2017-06-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/配置/" itemprop="url" rel="index">
                    <span itemprop="name">配置</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>在公司内网中，为了节约外网流量已经带宽，也为了安全目的，需要配置内网安全的yum源。</p>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ol>
<li>需要一台主机，作为内网yum源，这台主机通过rsync协议，rsync命令，去同步centos或者阿里云镜像。</li>
<li>配置yum服务器主机</li>
<li>配置客户端</li>
</ol>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ul>
<li>在yum主机上面新建存储仓库包的目录。并安装所需软件 createrepo 和 rsync</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装软件</span></div><div class="line">yum -y install createrepo rsync</div><div class="line"><span class="comment">#创建目录，我只用来放centos6.5的数据包</span></div><div class="line">mkdir -p /data/centos6.5 </div><div class="line"><span class="built_in">cd</span> /data/centos</div><div class="line"><span class="comment">#创建该仓库的索引目录</span></div><div class="line">createrepo -pdo /data/centos6.5 /data/centos6.5</div><div class="line"><span class="comment">#注意，我们在看官方源时候，分不清这个目录是什么。这个目录里面有os和update等子目录，这些子目录可以直接从官方源同步。理解为centos6.5总目录，里面放所有包</span></div></pre></td></tr></table></figure>
<ul>
<li>提供yum源文件查看。可用（nginx和python和apatch都可以）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 可以用Apache或nginx提供web服务，但用Python的http模块更简单，适用于内网环境</span></div><div class="line"><span class="built_in">cd</span> /data/centos6.5</div><div class="line">python -m SimpleHTTPServer 80 &amp;&gt;/dev/null &amp;</div><div class="line"><span class="comment">#可以通过浏览器输入本机IP查看。</span></div></pre></td></tr></table></figure>
<ul>
<li>放rpm包在仓库中。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 只下载软件不安装,若没有yumdownloader，就安装。</span></div><div class="line">yumdownloader pcre-devel openssl-devel </div><div class="line">createrepo --update /data/centos6.5  </div><div class="line"><span class="comment"># 每加入一个rpm包就要更新一下。</span></div><div class="line"><span class="comment">#平时yum安装软件时不删除安装包</span></div><div class="line"><span class="comment"># cat /etc/yum.conf </span></div><div class="line">keepcache=1</div><div class="line"><span class="comment"># 安装包存储目录</span></div><div class="line">cachedir=/var/cache/yum/<span class="variable">$basearch</span>/<span class="variable">$releasever</span></div><div class="line"><span class="comment"># /var/cache/yum/x86_64/6/base/packages</span></div></pre></td></tr></table></figure>
<ul>
<li>用rcync同步官方源到我的本地源服务器 。</li>
</ul>
<p>上面第3步只是将自己制作的rpm包，放入yum源。但还有一种企业需求，说的更具体一点，平时学生上课yum安装软件都是从公网下载的，占用带宽，因此在学校里搭建一个内网yum服务器，但又考虑到学生回家也要使用yum安装软件，如果yum软件的数据库文件repodata不一样，就会有问题。因此我想到的解决方法就是直接使用公网yum源的repodata。</p>
<p>镜像同步公网yum源<br>上游yum源必须要支持rsync协议，否则不能使用rsync进行同步。<br><a href="http://mirrors.ustc.edu.cn/status/" target="_blank" rel="external">http://mirrors.ustc.edu.cn/status/</a><br>CentOS官方标准源：rsync://mirrors.ustc.edu.cn/centos/<br>epel源：rsync://mirrors.ustc.edu.cn/epel/<br>同步命令：<br>使用rsync同步yum源，为了节省带宽、磁盘和下载时间，我只同步了CentOS6的rpm包，这样所有的rpm包只占用了21G，全部同步需要300G左右。<br>同步base源，小技巧，我们安装系统的光盘镜像含有部分rpm包，大概3G，这些就不用重新下载。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#将官方的源，同步到本地，-a是保持所有源属性。</span></div><div class="line">/usr/bin/rsync -avzL rsync://mirrors.ustc.edu.cn/centos/6/ /data/centos6.5/</div><div class="line">/usr/bin/rsync -avzL rsync://mirrors.ustc.edu.cn/centos/7/ /data/centos7.2/</div><div class="line">/usr/bin/rsync -avzL rsync://mirrors.ustc.edu.cn/centos/5/ /data/centos5/</div><div class="line"><span class="comment"># epel源</span></div><div class="line">/usr/bin/rsync -av --exclude=debug rsync://mirrors.ustc.edu.cn/epel/6/x86_64/ /data/yum_data/epel/6/x86_64/</div></pre></td></tr></table></figure>
<p>结果展示<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">[root@KVM data]<span class="comment"># du -sh yum_data    </span></div><div class="line">21G     yum_data</div><div class="line">[root@KVM data]<span class="comment"># tree -L 3 yum_data/</span></div><div class="line">yum_data/</div><div class="line">├── centos</div><div class="line">│   ├── 6.5</div><div class="line">│   │   ├── extras</div><div class="line">│   │   ├── os</div><div class="line">│   │   └── updates</div><div class="line">│   └── RPM-GPG-KEY-CentOS-6</div><div class="line">├── epel</div><div class="line">│   └── 6</div><div class="line">│       └── x86_64</div></pre></td></tr></table></figure></p>
<ol>
<li>客户端配置</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># cd /etc/yum.repos.d</span></div><div class="line">[root@B yum.repos.d]<span class="comment"># vi zingsman.repo</span></div><div class="line">[zingsman]</div><div class="line">name=Server</div><div class="line">baseurl=http://10.0.0.5</div><div class="line"><span class="built_in">enable</span>=1</div><div class="line">gpgcheck=0</div><div class="line">[root@YUM ~]<span class="comment"># yum --enablerepo=zingsman --disablerepo=base,extras,updates,epel list </span></div><div class="line"><span class="comment"># 指定使用zingsman库</span></div></pre></td></tr></table></figure>
<p>上面是临时使用内网yum源，想永久并简单使用yum -y install lrzsz命令，就需要修改配置文件将默认的repo文件关闭。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">[root@oldboy ~]<span class="comment"># cd /etc/yum.repos.d/</span></div><div class="line">[root@oldboy yum.repos.d]<span class="comment"># vim CentOS-Base.repo</span></div><div class="line"><span class="comment"># 在每一个启动的源加上</span></div><div class="line"><span class="comment"># enabled=0   #改为1就启用，没有此参数也是启用。</span></div><div class="line">[base]</div><div class="line">…………</div><div class="line">enabled=0</div><div class="line">[updates]</div><div class="line">…………</div><div class="line">enabled=0</div><div class="line">[extras]</div><div class="line">…………</div><div class="line">enabled=0</div><div class="line"><span class="comment"># 还有其他开启的仓库就使用这个办法关闭。</span></div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/19/shell-panduan/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/19/shell-panduan/" itemprop="url">
                  shell中条件测试与判断语句
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-19T14:21:48+08:00">
                2017-06-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SHELL/" itemprop="url" rel="index">
                    <span itemprop="name">SHELL</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-概述"><a href="#1-概述" class="headerlink" title="1. 概述"></a>1. 概述</h3><p>在shell中，执行条件表达式后会返回<code>真</code>或<code>假</code>，<code>0</code>表示真，非0表示假。下列是常见的条件测试常用的语法。</p>
<ol>
<li>test &lt;测试表达示&gt;   test后面有个空格，再接表达式。</li>
<li>[ 测试表达式 ]      中括号里面，左右各有一个空格。</li>
<li>[[ 测试表达式 ]]    双中括号，是很新的用法。</li>
<li>((测试表达式))      这个两端不需要空格<br>注意：第一种用法和第二种用法是等价的，2方法用的更广，里面可以使用通配符进行匹配。<br>“&amp;&amp;、||、&gt;、&lt;、”通常是出现在[[]]中，而[]中一般用 -a -o -gt -lt 代替判断符号</li>
</ol>
<h3 id="2-逻辑操作符-amp-amp"><a href="#2-逻辑操作符-amp-amp" class="headerlink" title="2. 逻辑操作符 &amp;&amp; ||"></a>2. 逻辑操作符 &amp;&amp; ||</h3><p>例子：<br><code>test -f file &amp;&amp; echo true || echo false</code><br>在上面例子中，如果file文件存在，返回0，代表真。<br>&amp;&amp; 代表前一次为真才执行。  || 表示，为假才执行。注意<strong><code>test -f file</code>返回结果假如第一次逻辑运算不匹配，会继续传到后面去</strong></p>
<blockquote>
<p>关于test,使用用法，可以使用man test查看</p>
</blockquote>
<p>test 命令的测试功能非常强大，和[]和[[]] 功能重合。可以选择性使用</p>
<h3 id="3-举例"><a href="#3-举例" class="headerlink" title="3. 举例"></a>3. 举例</h3><ol>
<li><code>test -f file</code> 等价于 <code>[ -f file ]</code> </li>
<li>双中括号使用，双中括号里面两端也需要空格。<br><code>[[ -f file ]] &amp;&amp; echo yes || echo no</code></li>
<li>test 常用参数，可以判断是否为空，各种权限（rwx），大小，文件的新旧等 </li>
</ol>
<h3 id="4-特殊条件测试表达式举例-不使用if条件判断示情况下"><a href="#4-特殊条件测试表达式举例-不使用if条件判断示情况下" class="headerlink" title="4. 特殊条件测试表达式举例(不使用if条件判断示情况下)"></a>4. 特殊条件测试表达式举例(不使用if条件判断示情况下)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[ 表达式 ] &amp;&amp;&#123;</div><div class="line">    命令1</div><div class="line">    命令2</div><div class="line">&#125;</div><div class="line">[[ 表达式 ]] &amp;&amp;&#123;</div><div class="line">    命令1 </div><div class="line">    命令2 </div><div class="line">&#125;</div><div class="line">test 条件1 &amp;&amp;&#123;</div><div class="line">    命令1</div><div class="line">    命令2</div><div class="line">&#125;</div><div class="line">#使用if判断结构</div><div class="line">if [ 表达式 ]</div><div class="line">  then</div><div class="line">    命令1</div><div class="line">    命令2</div><div class="line">fi</div></pre></td></tr></table></figure>
<h3 id="5-字符串测试操作符"><a href="#5-字符串测试操作符" class="headerlink" title="5. 字符串测试操作符"></a>5. 字符串测试操作符</h3><p>可以使用 -n 参数 ，代表后面字符串不等于空， -z 参数，代表字符串为空<br>还可以使用 =  或者 != 表示两个字符串相等或者等。这里是指内容相当而不是长度。<br>整数二元比较操作符使用参考：</p>
<table>
<thead>
<tr>
<th>在[]和test中使用</th>
<th>在(())和[[]]中使用</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-eq</td>
<td>==或=</td>
<td>相等，全拼为equal </td>
</tr>
<tr>
<td>-ne</td>
<td>!=</td>
<td>不相等，全拼为not equal </td>
</tr>
<tr>
<td>-ge</td>
<td>&gt;=</td>
<td>大于等于，全拼为greater than </td>
</tr>
<tr>
<td>-gt</td>
<td>&gt;</td>
<td>大于，全拼为greater equal </td>
</tr>
<tr>
<td>-le</td>
<td>&lt;=</td>
<td>小于等于，全拼为less equal </td>
</tr>
<tr>
<td>-lt</td>
<td>&lt;</td>
<td>小于，全拼为less than </td>
</tr>
</tbody>
</table>
<p><strong>注意</strong> 一般来说，[]里面是不能&lt;或者&gt;,但是可以先使用转义符</p>
<h3 id="6-逻辑比较符"><a href="#6-逻辑比较符" class="headerlink" title="6. 逻辑比较符"></a>6. 逻辑比较符</h3><table>
<thead>
<tr>
<th>在[]和test中使用</th>
<th>在(())和[[]]中使用</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>&amp;&amp;</td>
<td>and，与，两端为真，则结果为真</td>
</tr>
<tr>
<td>-o</td>
<td>两竖</td>
<td>or，或，两端有一个为真，则结果为真</td>
</tr>
<tr>
<td>!</td>
<td>!</td>
<td>not,非，两端相反，则结果为真</td>
</tr>
</tbody>
</table>
<p>举例：<br><code>[ -f file1 -a -f file2 ] &amp;&amp; echo yes || echo no</code></p>
<h3 id="7-企业案例"><a href="#7-企业案例" class="headerlink" title="7. 企业案例"></a>7. 企业案例</h3><p>输入或者通过命令传入一个字符或数字，如果传入的数字等于1，就打印1；<br>如果等于2，就打印2.如果不等于1也不等于2.就提示输入不对。然后退出程序。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">read -p &quot;please input your result:&quot; a</div><div class="line">[ &quot;$a&quot; == &quot;1&quot; ] &amp;&amp; echo 1 &amp;&amp; exit 0</div><div class="line">[ &quot;$a&quot; == &quot;2&quot; ] &amp;&amp; echo 2 &amp;&amp; exit 2</div><div class="line">[ &quot;$a&quot; -ne  &quot;1&quot; -o &quot;$a&quot; -ne &quot;2&quot; ] &amp;&amp;&#123;</div><div class="line">        echo &quot;your input error!&quot;</div><div class="line">        exit 1</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/19/shell-operator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/19/shell-operator/" itemprop="url">
                  shell中的运算
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-19T10:01:43+08:00">
                2017-06-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SHELL/" itemprop="url" rel="index">
                    <span itemprop="name">SHELL</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-常见的shell算术运算符"><a href="#1-常见的shell算术运算符" class="headerlink" title="1. 常见的shell算术运算符"></a>1. 常见的shell算术运算符</h3><ul>
<li>+ - x / % ** ++ --  加 减 乘 除 取 余 幂运算 增加 减少</li>
<li>! &amp;&amp; ||  非 逻辑与 逻辑或</li>
<li>大于 小于 等于 大于等于 小于 等于（==）不等于（!==）赋值（=）</li>
<li>>> \&lt;\&lt; 向右偏移，向左偏移</li>
</ul>
<h3 id="2-Shell-中常见的算术运算命令"><a href="#2-Shell-中常见的算术运算命令" class="headerlink" title="2. Shell 中常见的算术运算命令"></a>2. Shell 中常见的算术运算<strong>命令</strong></h3><ul>
<li>(())   用于整数运算的常用运算符，效率较高</li>
<li>let    用于整数的运算，类似于“(())”</li>
<li>expr   用于整数运算，还有很多其他额外功能（判断是否为整数）</li>
<li>bc     Linux下自带的一个计算器程序（整数和小数计算）</li>
<li>$[]    用于整数运算</li>
<li>awk    awk既可以用于整数运算，也可用于小数运算</li>
<li>declare 定义变量的属性，-i 参数就是定义整型变量</li>
</ul>
<h3 id="3-使用举例"><a href="#3-使用举例" class="headerlink" title="3. 使用举例"></a>3. 使用举例</h3><ol>
<li><p>((1+1))  可以使用成”echo ((1+1))” 或者 ((8&gt;7&amp;&amp;5==5)) 或者 i=$((i+1))<br>提示： 在(()) 中使用变量可以将$符号省略<br>利用(())制作一个简单的计算器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#/bin/bash</div><div class="line">if [ $# != 2 ]</div><div class="line">then</div><div class="line">echo &quot;please input two args,Age: /bin/sh $0 10 5&quot;</div><div class="line">exit 1</div><div class="line">fi</div><div class="line">echo &quot;$1+$2=$(($1+$2))&quot;</div><div class="line">echo &quot;$1-$2=$(($1-$2))&quot;</div><div class="line">echo &quot;$1*$2=$(($1*$2))&quot;</div><div class="line">echo &quot;$1/$2=$(($1/$2))&quot;</div><div class="line">echo &quot;$1**$2=$(($1**$2))&quot;</div><div class="line">echo &quot;$1%$2=$(($1%$2))&quot;</div></pre></td></tr></table></figure>
</li>
<li><p>let运算命令用法<br>格式： let 赋值表达式  例如: let i=i+8 &amp;&amp; echo $1<br>这个用法等同于((i+8)), (())这种方式效率更高<br>例子: 使用let，对web服务页面进行监控<br>在这里我们使用<code>wget</code> 命令可以<strong>检测某网页是否能正常访问</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">checkurl()&#123;</div><div class="line">timeout=5</div><div class="line">fails=0</div><div class="line">success=0</div><div class="line">while true #死循环，一直检测</div><div class="line">do</div><div class="line">wget --timeout=$timeout --tries=1 www.baidu.com -q -O /dev/null</div><div class="line">echo $fails $success</div><div class="line">if [ $? -ne 0 ]   #返回值不为0 就表示失败</div><div class="line">then</div><div class="line">        let fails=fails+1     #可用((fails=fails+1))代替</div><div class="line">echo $fails </div><div class="line">else</div><div class="line">        let success=success+1  #返回为0，代表访问成功</div><div class="line">echo $success</div><div class="line">fi</div><div class="line">if [ $success -ge 1 ]</div><div class="line">then</div><div class="line">echo &apos;sys is open!&apos;</div><div class="line">exit 0</div><div class="line">fi</div><div class="line">if [ $fails -ge 2 ]</div><div class="line">then</div><div class="line">echo &quot;sys is down!&quot;</div><div class="line">#mail -s &quot;sys is down&quot; root@localhost  #如果访问失败次数大于等于2，就发邮件告警</div><div class="line">exit 2</div><div class="line">fi</div><div class="line">done</div><div class="line">&#125;</div><div class="line">ehceckurl #执行函数</div></pre></td></tr></table></figure>
</li>
<li><p>expr 命令用法<br>格式： expr(evaluate(求值) expressions(表达式)) 它既可用于整数，也可小数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">expr 2 + 2  #数字作用至少有一个空格，使用乘号，需要使用\转义 </div><div class="line">4</div><div class="line">i=`expr $i + 6`</div></pre></td></tr></table></figure>
</li>
</ol>
<p>使用expr判断变量是否是一个整数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">read -p &quot;input a number:&quot; a</div><div class="line">expr $a + 1 &gt;/dev/null 2&gt;&amp;1</div><div class="line">[ $? -eq 0 ] &amp;&amp; echo &quot;$a is a int&quot; || echo &quot;$a is a chars&quot;</div></pre></td></tr></table></figure></p>
<p>提示：也可以使用expr match 功能进行整数判断，可执行 man expr 获得帮助</p>
<ol>
<li><p>利用expr 判断扩展名是否符合要求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">if expr &quot;$1&quot; : &quot;.*\.pub&quot; &amp;&gt;/dev/null</div><div class="line">then</div><div class="line">echo &quot;your are useing $1&quot;</div><div class="line">else</div><div class="line">echo &quot;your use *.pbu file&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
</li>
<li><p>利用expr 计算字符串的长度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[admin@web_server ~]$ char=&apos;pengke&apos;</div><div class="line">[admin@web_server ~]$ expr length &apos;$char&apos;</div><div class="line">5</div></pre></td></tr></table></figure>
</li>
<li><p>利用bc命令来计算，它是Linux下面的计算器<br>按下bc后，就能进入运算界面。或者：<br><code>echo 3+5 | bc</code></p>
</li>
<li><p>利用sed 生成连续的数字序列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sed -s &quot;+&quot; 10      # -s 是自定义分隔符</div><div class="line">1+2+3+4+5+6+7+8+9+10</div><div class="line">echo  &#123;1..10&#125; | tr &quot; &quot; &quot;+&quot;   #生产空格分隔的数列，用tr将空格替换成+</div><div class="line">1+2+3+4+5+6+7+8+9+10</div></pre></td></tr></table></figure>
</li>
<li><p>利用awk实现运算<br>echo “7.7 3.8” | awk ‘{print ($1-$2)}’</p>
</li>
</ol>
<h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4. 总结"></a>4. 总结</h3><p>大多运算命令都支持整数，支持小数的有：expr 和awk<br>expr 和 awk 都是很重要的命令</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/08/使用markdown/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/08/使用markdown/" itemprop="url">
                  使用markdown
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-08T11:34:45+08:00">
                2017-06-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/HELP/" itemprop="url" rel="index">
                    <span itemprop="name">HELP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Markdown简明语法手册"><a href="#Markdown简明语法手册" class="headerlink" title="Markdown简明语法手册"></a>Markdown简明语法手册</h1><h3 id="1-斜体和粗体"><a href="#1-斜体和粗体" class="headerlink" title="1. 斜体和粗体"></a>1. 斜体和粗体</h3><p>使用* 和 ** 表示斜体和粗体，用*或**包起来<br>例子：<br>这是 <em>斜体</em>，这是<strong>粗体</strong></p>
<h3 id="2-分级标题"><a href="#2-分级标题" class="headerlink" title="2. 分级标题"></a>2. 分级标题</h3><p>使用 # 代表一级标题， ## 代表二级标题， ### 代表三级标题，一次类推。<br>例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 这是一个一级标题</div><div class="line">## 这是一个二级标题</div><div class="line">### 这是一个三级标题</div></pre></td></tr></table></figure></p>
<p>注意： Markdown一共支持六级标题。</p>
<h3 id="3-外连接"><a href="#3-外连接" class="headerlink" title="3. 外连接"></a>3. 外连接</h3><p>使用 [描述](链接地址) 为文字添加外链接。<br>图片为：![](){ImgCap}{/ImgCap}<br>链接为：[]()<br>例子：<br>这是给大家推荐的淘宝内部券网站: <a href="www.higouwang.com">嗨购王</a> 的链接。</p>
<h3 id="4-无序列表"><a href="#4-无序列表" class="headerlink" title="4. 无序列表"></a>4. 无序列表</h3><p>使用 * , - ,表示无须列表<br>例子：</p>
<ul>
<li>无序列表项 一</li>
<li>无序列表项 二</li>
<li>无序列表项 三</li>
</ul>
<h3 id="5-有序列表"><a href="#5-有序列表" class="headerlink" title="5. 有序列表"></a>5. 有序列表</h3><p>使用数字和点表示有序列表，符号要和文字之间加上一个字符的空格。<br>例子：</p>
<ol>
<li>有序列表项 一</li>
<li>有序列表项 二</li>
<li>有序列表项 三 </li>
</ol>
<h3 id="6-分割线"><a href="#6-分割线" class="headerlink" title="6. 分割线"></a>6. 分割线</h3><p>分割线的语法只需要三个 * 号。例如<br>你愿意和我一起学习吗？</p>
<hr>
<p>我们去小树林玩耍可好～</p>
<h3 id="7-文字引用"><a href="#7-文字引用" class="headerlink" title="7. 文字引用"></a>7. 文字引用</h3><p>使用 &gt; 表示文字引用。注意符合后面的一个空格。应用完有一条<strong>空行</strong>。<br>示例：</p>
<blockquote>
<p>野火烧不尽，春风吹又生。</p>
</blockquote>
<h3 id="8-行内代码块"><a href="#8-行内代码块" class="headerlink" title="8. 行内代码块"></a>8. 行内代码块</h3><p>使用 `代码` 表示行内代码块。<br>示例：<br>让我们聊聊 <code>html</code> 你能教给我吗？<br>注意：使用 <code>tab</code> 可缩进</p>
<h3 id="9-插入图像"><a href="#9-插入图像" class="headerlink" title="9. 插入图像"></a>9. 插入图像</h3><p>使用 ![描述](图片链接地址) 插入图像。<br>图片为：![](){ImgCap}{/ImgCap}<br>链接为：[]()<br>例子：<br><img src="http://pke-data.oss-cn-shenzhen.aliyuncs.com/image/avatar.png" alt="美女"></p>
<h3 id="11-加强的代码块"><a href="#11-加强的代码块" class="headerlink" title="11. 加强的代码块"></a>11. 加强的代码块</h3><p>使用 ``` 是基本高亮<br>使用 ```python 是针对语言高亮<br>例如：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash">/bin/bash</span></div><div class="line">ip=$(cat aa)</div><div class="line">for a in ip</div><div class="line">do</div><div class="line">        ping -c 1 -w 3 $ip$a &amp;&gt; /dev/null</div><div class="line">        if [ $? == 0 ];then</div><div class="line">        echo "$ip is OK!"</div><div class="line">        else</div><div class="line">        echo -e "\e[1;31m $ip is NO! \e[0m"</div><div class="line">        fi</div><div class="line">done</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/06/article-title/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZingsMan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZingsMan">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/06/article-title/" itemprop="url">
                  article title
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-06T10:14:49+08:00">
                2017-06-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/测试/" itemprop="url" rel="index">
                    <span itemprop="name">测试</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>第一个测试blog文件<br>hello word<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ls </div><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ls </div><div class="line">$ hexo new <span class="string">"My New Post"</span></div><div class="line">`````` bash</div><div class="line">ls </div><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p><code>$ hexo new &quot;My New Post&quot;</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="ZingsMan" />
          <p class="site-author-name" itemprop="name">ZingsMan</p>
           
              <p class="site-description motion-element" itemprop="description">业精于勤荒于嬉,行成于思毁于随。</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/zingsman" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/zingsman" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/zingsman" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZingsMan</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
